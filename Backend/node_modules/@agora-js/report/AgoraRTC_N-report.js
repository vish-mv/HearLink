/**
 * AgoraWebSDK_N-v4.20.0-0-g334e514b-dirty Copyright AgoraInc.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@agora-js/shared"),require("axios")):"function"==typeof define&&define.amd?define(["exports","@agora-js/shared","axios"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).AgoraRTCReport={},t.shared$8,t.Axios)}(this,(function(t,e,r){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i={exports:{}},a=function(t){return t&&t.Math==Math&&t},s=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof n&&n)||function(){return this}()||n||Function("return this")(),c=function(t){try{return!!t()}catch(t){return!0}},u=!c((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),p=u,l=Function.prototype,f=l.apply,d=l.call,h="object"==typeof Reflect&&Reflect.apply||(p?d.bind(f):function(){return d.apply(f,arguments)}),E=u,g=Function.prototype,v=g.call,T=E&&g.bind.bind(v,v),y=E?T:function(t){return function(){return v.apply(t,arguments)}},m=y,S=m({}.toString),_=m("".slice),R=function(t){return _(S(t),8,-1)},O=R,A=y,I=function(t){if("Function"===O(t))return A(t)},b="object"==typeof document&&document.all,P={all:b,IS_HTMLDDA:void 0===b&&void 0!==b},w=P.all,C=P.IS_HTMLDDA?function(t){return"function"==typeof t||t===w}:function(t){return"function"==typeof t},N={},D=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),L=u,U=Function.prototype.call,M=L?U.bind(U):function(){return U.apply(U,arguments)},j={},x={}.propertyIsEnumerable,W=Object.getOwnPropertyDescriptor,k=W&&!x.call({1:2},1);j.f=k?function(t){var e=W(this,t);return!!e&&e.enumerable}:x;var V,G,F=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},B=c,J=R,Y=Object,K=y("".split),H=B((function(){return!Y("z").propertyIsEnumerable(0)}))?function(t){return"String"==J(t)?K(t,""):Y(t)}:Y,Q=function(t){return null==t},q=Q,X=TypeError,z=function(t){if(q(t))throw X("Can't call method on "+t);return t},$=H,Z=z,tt=function(t){return $(Z(t))},et=C,rt=P.all,nt=P.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:et(t)||t===rt}:function(t){return"object"==typeof t?null!==t:et(t)},ot={},it=ot,at=s,st=C,ct=function(t){return st(t)?t:void 0},ut=function(t,e){return arguments.length<2?ct(it[t])||ct(at[t]):it[t]&&it[t][e]||at[t]&&at[t][e]},pt=y({}.isPrototypeOf),lt="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ft=s,dt=lt,ht=ft.process,Et=ft.Deno,gt=ht&&ht.versions||Et&&Et.version,vt=gt&&gt.v8;vt&&(G=(V=vt.split("."))[0]>0&&V[0]<4?1:+(V[0]+V[1])),!G&&dt&&(!(V=dt.match(/Edge\/(\d+)/))||V[1]>=74)&&(V=dt.match(/Chrome\/(\d+)/))&&(G=+V[1]);var Tt=G,yt=Tt,mt=c,St=s.String,_t=!!Object.getOwnPropertySymbols&&!mt((function(){var t=Symbol();return!St(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&yt&&yt<41})),Rt=_t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ot=ut,At=C,It=pt,bt=Object,Pt=Rt?function(t){return"symbol"==typeof t}:function(t){var e=Ot("Symbol");return At(e)&&It(e.prototype,bt(t))},wt=String,Ct=function(t){try{return wt(t)}catch(t){return"Object"}},Nt=C,Dt=Ct,Lt=TypeError,Ut=function(t){if(Nt(t))return t;throw Lt(Dt(t)+" is not a function")},Mt=Ut,jt=Q,xt=function(t,e){var r=t[e];return jt(r)?void 0:Mt(r)},Wt=M,kt=C,Vt=nt,Gt=TypeError,Ft={exports:{}},Bt=s,Jt=Object.defineProperty,Yt=function(t,e){try{Jt(Bt,t,{value:e,configurable:!0,writable:!0})}catch(r){Bt[t]=e}return e},Kt="__core-js_shared__",Ht=s[Kt]||Yt(Kt,{}),Qt=Ht;(Ft.exports=function(t,e){return Qt[t]||(Qt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var qt=Ft.exports,Xt=z,zt=Object,$t=function(t){return zt(Xt(t))},Zt=$t,te=y({}.hasOwnProperty),ee=Object.hasOwn||function(t,e){return te(Zt(t),e)},re=y,ne=0,oe=Math.random(),ie=re(1..toString),ae=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ie(++ne+oe,36)},se=qt,ce=ee,ue=ae,pe=_t,le=Rt,fe=s.Symbol,de=se("wks"),he=le?fe.for||fe:fe&&fe.withoutSetter||ue,Ee=function(t){return ce(de,t)||(de[t]=pe&&ce(fe,t)?fe[t]:he("Symbol."+t)),de[t]},ge=M,ve=nt,Te=Pt,ye=xt,me=function(t,e){var r,n;if("string"===e&&kt(r=t.toString)&&!Vt(n=Wt(r,t)))return n;if(kt(r=t.valueOf)&&!Vt(n=Wt(r,t)))return n;if("string"!==e&&kt(r=t.toString)&&!Vt(n=Wt(r,t)))return n;throw Gt("Can't convert object to primitive value")},Se=TypeError,_e=Ee("toPrimitive"),Re=function(t,e){if(!ve(t)||Te(t))return t;var r,n=ye(t,_e);if(n){if(void 0===e&&(e="default"),r=ge(n,t,e),!ve(r)||Te(r))return r;throw Se("Can't convert object to primitive value")}return void 0===e&&(e="number"),me(t,e)},Oe=Pt,Ae=function(t){var e=Re(t,"string");return Oe(e)?e:e+""},Ie=nt,be=s.document,Pe=Ie(be)&&Ie(be.createElement),we=function(t){return Pe?be.createElement(t):{}},Ce=we,Ne=!D&&!c((function(){return 7!=Object.defineProperty(Ce("div"),"a",{get:function(){return 7}}).a})),De=D,Le=M,Ue=j,Me=F,je=tt,xe=Ae,We=ee,ke=Ne,Ve=Object.getOwnPropertyDescriptor;N.f=De?Ve:function(t,e){if(t=je(t),e=xe(e),ke)try{return Ve(t,e)}catch(t){}if(We(t,e))return Me(!Le(Ue.f,t,e),t[e])};var Ge=c,Fe=C,Be=/#|\.prototype\./,Je=function(t,e){var r=Ke[Ye(t)];return r==Qe||r!=He&&(Fe(e)?Ge(e):!!e)},Ye=Je.normalize=function(t){return String(t).replace(Be,".").toLowerCase()},Ke=Je.data={},He=Je.NATIVE="N",Qe=Je.POLYFILL="P",qe=Je,Xe=Ut,ze=u,$e=I(I.bind),Ze=function(t,e){return Xe(t),void 0===e?t:ze?$e(t,e):function(){return t.apply(e,arguments)}},tr={},er=D&&c((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),rr=nt,nr=String,or=TypeError,ir=function(t){if(rr(t))return t;throw or(nr(t)+" is not an object")},ar=D,sr=Ne,cr=er,ur=ir,pr=Ae,lr=TypeError,fr=Object.defineProperty,dr=Object.getOwnPropertyDescriptor,hr="enumerable",Er="configurable",gr="writable";tr.f=ar?cr?function(t,e,r){if(ur(t),e=pr(e),ur(r),"function"==typeof t&&"prototype"===e&&"value"in r&&gr in r&&!r[gr]){var n=dr(t,e);n&&n[gr]&&(t[e]=r.value,r={configurable:Er in r?r[Er]:n[Er],enumerable:hr in r?r[hr]:n[hr],writable:!1})}return fr(t,e,r)}:fr:function(t,e,r){if(ur(t),e=pr(e),ur(r),sr)try{return fr(t,e,r)}catch(t){}if("get"in r||"set"in r)throw lr("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var vr=tr,Tr=F,yr=D?function(t,e,r){return vr.f(t,e,Tr(1,r))}:function(t,e,r){return t[e]=r,t},mr=s,Sr=h,_r=I,Rr=C,Or=N.f,Ar=qe,Ir=ot,br=Ze,Pr=yr,wr=ee,Cr=function(t){var e=function(r,n,o){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,n)}return new t(r,n,o)}return Sr(t,this,arguments)};return e.prototype=t.prototype,e},Nr=function(t,e){var r,n,o,i,a,s,c,u,p,l=t.target,f=t.global,d=t.stat,h=t.proto,E=f?mr:d?mr[l]:(mr[l]||{}).prototype,g=f?Ir:Ir[l]||Pr(Ir,l,{})[l],v=g.prototype;for(i in e)n=!(r=Ar(f?i:l+(d?".":"#")+i,t.forced))&&E&&wr(E,i),s=g[i],n&&(c=t.dontCallGetSet?(p=Or(E,i))&&p.value:E[i]),a=n&&c?c:e[i],n&&typeof s==typeof a||(u=t.bind&&n?br(a,mr):t.wrap&&n?Cr(a):h&&Rr(a)?_r(a):a,(t.sham||a&&a.sham||s&&s.sham)&&Pr(u,"sham",!0),Pr(g,i,u),h&&(wr(Ir,o=l+"Prototype")||Pr(Ir,o,{}),Pr(Ir[o],i,a),t.real&&v&&(r||!v[i])&&Pr(v,i,a)))},Dr=Nr,Lr=D,Ur=tr.f;Dr({target:"Object",stat:!0,forced:Object.defineProperty!==Ur,sham:!Lr},{defineProperty:Ur});var Mr=ot.Object,jr=i.exports=function(t,e,r){return Mr.defineProperty(t,e,r)};Mr.defineProperty.sham&&(jr.sham=!0);var xr=o(i.exports),Wr=R,kr=Array.isArray||function(t){return"Array"==Wr(t)},Vr=Math.ceil,Gr=Math.floor,Fr=Math.trunc||function(t){var e=+t;return(e>0?Gr:Vr)(e)},Br=function(t){var e=+t;return e!=e||0===e?0:Fr(e)},Jr=Br,Yr=Math.min,Kr=function(t){return t>0?Yr(Jr(t),9007199254740991):0},Hr=function(t){return Kr(t.length)},Qr=TypeError,qr=Ae,Xr=tr,zr=F,$r=function(t,e,r){var n=qr(e);n in t?Xr.f(t,n,zr(0,r)):t[n]=r},Zr={};Zr[Ee("toStringTag")]="z";var tn="[object z]"===String(Zr),en=tn,rn=C,nn=R,on=Ee("toStringTag"),an=Object,sn="Arguments"==nn(function(){return arguments}()),cn=en?nn:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=an(t),on))?r:sn?nn(e):"Object"==(n=nn(e))&&rn(e.callee)?"Arguments":n},un=C,pn=Ht,ln=y(Function.toString);un(pn.inspectSource)||(pn.inspectSource=function(t){return ln(t)});var fn=pn.inspectSource,dn=y,hn=c,En=C,gn=cn,vn=fn,Tn=function(){},yn=[],mn=ut("Reflect","construct"),Sn=/^\s*(?:class|function)\b/,_n=dn(Sn.exec),Rn=!Sn.exec(Tn),On=function(t){if(!En(t))return!1;try{return mn(Tn,yn,t),!0}catch(t){return!1}},An=function(t){if(!En(t))return!1;switch(gn(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rn||!!_n(Sn,vn(t))}catch(t){return!0}};An.sham=!0;var In=!mn||hn((function(){var t;return On(On.call)||!On(Object)||!On((function(){t=!0}))||t}))?An:On,bn=kr,Pn=In,wn=nt,Cn=Ee("species"),Nn=Array,Dn=function(t){var e;return bn(t)&&(e=t.constructor,(Pn(e)&&(e===Nn||bn(e.prototype))||wn(e)&&null===(e=e[Cn]))&&(e=void 0)),void 0===e?Nn:e},Ln=function(t,e){return new(Dn(t))(0===e?0:e)},Un=c,Mn=Tt,jn=Ee("species"),xn=Nr,Wn=c,kn=kr,Vn=nt,Gn=$t,Fn=Hr,Bn=function(t){if(t>9007199254740991)throw Qr("Maximum allowed index exceeded");return t},Jn=$r,Yn=Ln,Kn=function(t){return Mn>=51||!Un((function(){var e=[];return(e.constructor={})[jn]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Hn=Tt,Qn=Ee("isConcatSpreadable"),qn=Hn>=51||!Wn((function(){var t=[];return t[Qn]=!1,t.concat()[0]!==t})),Xn=function(t){if(!Vn(t))return!1;var e=t[Qn];return void 0!==e?!!e:kn(t)};xn({target:"Array",proto:!0,arity:1,forced:!qn||!Kn("concat")},{concat:function(t){var e,r,n,o,i,a=Gn(this),s=Yn(a,0),c=0;for(e=-1,n=arguments.length;e<n;e++)if(Xn(i=-1===e?a:arguments[e]))for(o=Fn(i),Bn(c+o),r=0;r<o;r++,c++)r in i&&Jn(s,c,i[r]);else Bn(c+1),Jn(s,c++,i);return s.length=c,s}});var zn=cn,$n=String,Zn=function(t){if("Symbol"===zn(t))throw TypeError("Cannot convert a Symbol value to a string");return $n(t)},to={},eo=Br,ro=Math.max,no=Math.min,oo=function(t,e){var r=eo(t);return r<0?ro(r+e,0):no(r,e)},io=tt,ao=oo,so=Hr,co=function(t){return function(e,r,n){var o,i=io(e),a=so(i),s=ao(n,a);if(t&&r!=r){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===r)return t||s||0;return!t&&-1}},uo={includes:co(!0),indexOf:co(!1)},po={},lo=ee,fo=tt,ho=uo.indexOf,Eo=po,go=y([].push),vo=function(t,e){var r,n=fo(t),o=0,i=[];for(r in n)!lo(Eo,r)&&lo(n,r)&&go(i,r);for(;e.length>o;)lo(n,r=e[o++])&&(~ho(i,r)||go(i,r));return i},To=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],yo=vo,mo=To,So=Object.keys||function(t){return yo(t,mo)},_o=D,Ro=er,Oo=tr,Ao=ir,Io=tt,bo=So;to.f=_o&&!Ro?Object.defineProperties:function(t,e){Ao(t);for(var r,n=Io(e),o=bo(e),i=o.length,a=0;i>a;)Oo.f(t,r=o[a++],n[r]);return t};var Po,wo=ut("document","documentElement"),Co=ae,No=qt("keys"),Do=function(t){return No[t]||(No[t]=Co(t))},Lo=ir,Uo=to,Mo=To,jo=po,xo=wo,Wo=we,ko="prototype",Vo="script",Go=Do("IE_PROTO"),Fo=function(){},Bo=function(t){return"<"+Vo+">"+t+"</"+Vo+">"},Jo=function(t){t.write(Bo("")),t.close();var e=t.parentWindow.Object;return t=null,e},Yo=function(){try{Po=new ActiveXObject("htmlfile")}catch(t){}var t,e,r;Yo="undefined"!=typeof document?document.domain&&Po?Jo(Po):(e=Wo("iframe"),r="java"+Vo+":",e.style.display="none",xo.appendChild(e),e.src=String(r),(t=e.contentWindow.document).open(),t.write(Bo("document.F=Object")),t.close(),t.F):Jo(Po);for(var n=Mo.length;n--;)delete Yo[ko][Mo[n]];return Yo()};jo[Go]=!0;var Ko=Object.create||function(t,e){var r;return null!==t?(Fo[ko]=Lo(t),r=new Fo,Fo[ko]=null,r[Go]=t):r=Yo(),void 0===e?r:Uo.f(r,e)},Ho={},Qo=vo,qo=To.concat("length","prototype");Ho.f=Object.getOwnPropertyNames||function(t){return Qo(t,qo)};var Xo={},zo=oo,$o=Hr,Zo=$r,ti=Array,ei=Math.max,ri=function(t,e,r){for(var n=$o(t),o=zo(e,n),i=zo(void 0===r?n:r,n),a=ti(ei(i-o,0)),s=0;o<i;o++,s++)Zo(a,s,t[o]);return a.length=s,a},ni=R,oi=tt,ii=Ho.f,ai=ri,si="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Xo.f=function(t){return si&&"Window"==ni(t)?function(t){try{return ii(t)}catch(t){return ai(si)}}(t):ii(oi(t))};var ci={};ci.f=Object.getOwnPropertySymbols;var ui=yr,pi=function(t,e,r,n){return n&&n.enumerable?t[e]=r:ui(t,e,r),t},li=tr,fi=function(t,e,r){return li.f(t,e,r)},di={},hi=Ee;di.f=hi;var Ei,gi,vi,Ti=ot,yi=ee,mi=di,Si=tr.f,_i=function(t){var e=Ti.Symbol||(Ti.Symbol={});yi(e,t)||Si(e,t,{value:mi.f(t)})},Ri=M,Oi=ut,Ai=Ee,Ii=pi,bi=function(){var t=Oi("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=Ai("toPrimitive");e&&!e[n]&&Ii(e,n,(function(t){return Ri(r,this)}),{arity:1})},Pi=cn,wi=tn?{}.toString:function(){return"[object "+Pi(this)+"]"},Ci=tn,Ni=tr.f,Di=yr,Li=ee,Ui=wi,Mi=Ee("toStringTag"),ji=function(t,e,r,n){if(t){var o=r?t:t.prototype;Li(o,Mi)||Ni(o,Mi,{configurable:!0,value:e}),n&&!Ci&&Di(o,"toString",Ui)}},xi=C,Wi=s.WeakMap,ki=xi(Wi)&&/native code/.test(String(Wi)),Vi=s,Gi=nt,Fi=yr,Bi=ee,Ji=Ht,Yi=Do,Ki=po,Hi="Object already initialized",Qi=Vi.TypeError,qi=Vi.WeakMap;if(ki||Ji.state){var Xi=Ji.state||(Ji.state=new qi);Xi.get=Xi.get,Xi.has=Xi.has,Xi.set=Xi.set,Ei=function(t,e){if(Xi.has(t))throw Qi(Hi);return e.facade=t,Xi.set(t,e),e},gi=function(t){return Xi.get(t)||{}},vi=function(t){return Xi.has(t)}}else{var zi=Yi("state");Ki[zi]=!0,Ei=function(t,e){if(Bi(t,zi))throw Qi(Hi);return e.facade=t,Fi(t,zi,e),e},gi=function(t){return Bi(t,zi)?t[zi]:{}},vi=function(t){return Bi(t,zi)}}var $i={set:Ei,get:gi,has:vi,enforce:function(t){return vi(t)?gi(t):Ei(t,{})},getterFor:function(t){return function(e){var r;if(!Gi(e)||(r=gi(e)).type!==t)throw Qi("Incompatible receiver, "+t+" required");return r}}},Zi=Ze,ta=H,ea=$t,ra=Hr,na=Ln,oa=y([].push),ia=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,s=5==t||i;return function(c,u,p,l){for(var f,d,h=ea(c),E=ta(h),g=Zi(u,p),v=ra(E),T=0,y=l||na,m=e?y(c,v):r||a?y(c,0):void 0;v>T;T++)if((s||T in E)&&(d=g(f=E[T],T,h),t))if(e)m[T]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return T;case 2:oa(m,f)}else switch(t){case 4:return!1;case 7:oa(m,f)}return i?-1:n||o?o:m}},aa={forEach:ia(0),map:ia(1),filter:ia(2),some:ia(3),every:ia(4),find:ia(5),findIndex:ia(6),filterReject:ia(7)},sa=Nr,ca=s,ua=M,pa=y,la=D,fa=_t,da=c,ha=ee,Ea=pt,ga=ir,va=tt,Ta=Ae,ya=Zn,ma=F,Sa=Ko,_a=So,Ra=Ho,Oa=Xo,Aa=ci,Ia=N,ba=tr,Pa=to,wa=j,Ca=pi,Na=fi,Da=qt,La=po,Ua=ae,Ma=Ee,ja=di,xa=_i,Wa=bi,ka=ji,Va=$i,Ga=aa.forEach,Fa=Do("hidden"),Ba="Symbol",Ja="prototype",Ya=Va.set,Ka=Va.getterFor(Ba),Ha=Object[Ja],Qa=ca.Symbol,qa=Qa&&Qa[Ja],Xa=ca.TypeError,za=ca.QObject,$a=Ia.f,Za=ba.f,ts=Oa.f,es=wa.f,rs=pa([].push),ns=Da("symbols"),os=Da("op-symbols"),is=Da("wks"),as=!za||!za[Ja]||!za[Ja].findChild,ss=la&&da((function(){return 7!=Sa(Za({},"a",{get:function(){return Za(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=$a(Ha,e);n&&delete Ha[e],Za(t,e,r),n&&t!==Ha&&Za(Ha,e,n)}:Za,cs=function(t,e){var r=ns[t]=Sa(qa);return Ya(r,{type:Ba,tag:t,description:e}),la||(r.description=e),r},us=function(t,e,r){t===Ha&&us(os,e,r),ga(t);var n=Ta(e);return ga(r),ha(ns,n)?(r.enumerable?(ha(t,Fa)&&t[Fa][n]&&(t[Fa][n]=!1),r=Sa(r,{enumerable:ma(0,!1)})):(ha(t,Fa)||Za(t,Fa,ma(1,{})),t[Fa][n]=!0),ss(t,n,r)):Za(t,n,r)},ps=function(t,e){ga(t);var r=va(e),n=_a(r).concat(hs(r));return Ga(n,(function(e){la&&!ua(ls,r,e)||us(t,e,r[e])})),t},ls=function(t){var e=Ta(t),r=ua(es,this,e);return!(this===Ha&&ha(ns,e)&&!ha(os,e))&&(!(r||!ha(this,e)||!ha(ns,e)||ha(this,Fa)&&this[Fa][e])||r)},fs=function(t,e){var r=va(t),n=Ta(e);if(r!==Ha||!ha(ns,n)||ha(os,n)){var o=$a(r,n);return!o||!ha(ns,n)||ha(r,Fa)&&r[Fa][n]||(o.enumerable=!0),o}},ds=function(t){var e=ts(va(t)),r=[];return Ga(e,(function(t){ha(ns,t)||ha(La,t)||rs(r,t)})),r},hs=function(t){var e=t===Ha,r=ts(e?os:va(t)),n=[];return Ga(r,(function(t){!ha(ns,t)||e&&!ha(Ha,t)||rs(n,ns[t])})),n};fa||(Qa=function(){if(Ea(qa,this))throw Xa("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?ya(arguments[0]):void 0,e=Ua(t),r=function(t){this===Ha&&ua(r,os,t),ha(this,Fa)&&ha(this[Fa],e)&&(this[Fa][e]=!1),ss(this,e,ma(1,t))};return la&&as&&ss(Ha,e,{configurable:!0,set:r}),cs(e,t)},Ca(qa=Qa[Ja],"toString",(function(){return Ka(this).tag})),Ca(Qa,"withoutSetter",(function(t){return cs(Ua(t),t)})),wa.f=ls,ba.f=us,Pa.f=ps,Ia.f=fs,Ra.f=Oa.f=ds,Aa.f=hs,ja.f=function(t){return cs(Ma(t),t)},la&&Na(qa,"description",{configurable:!0,get:function(){return Ka(this).description}})),sa({global:!0,constructor:!0,wrap:!0,forced:!fa,sham:!fa},{Symbol:Qa}),Ga(_a(is),(function(t){xa(t)})),sa({target:Ba,stat:!0,forced:!fa},{useSetter:function(){as=!0},useSimple:function(){as=!1}}),sa({target:"Object",stat:!0,forced:!fa,sham:!la},{create:function(t,e){return void 0===e?Sa(t):ps(Sa(t),e)},defineProperty:us,defineProperties:ps,getOwnPropertyDescriptor:fs}),sa({target:"Object",stat:!0,forced:!fa},{getOwnPropertyNames:ds}),Wa(),ka(Qa,Ba),La[Fa]=!0;var Es=_t&&!!Symbol.for&&!!Symbol.keyFor,gs=Nr,vs=ut,Ts=ee,ys=Zn,ms=qt,Ss=Es,_s=ms("string-to-symbol-registry"),Rs=ms("symbol-to-string-registry");gs({target:"Symbol",stat:!0,forced:!Ss},{for:function(t){var e=ys(t);if(Ts(_s,e))return _s[e];var r=vs("Symbol")(e);return _s[e]=r,Rs[r]=e,r}});var Os=Nr,As=ee,Is=Pt,bs=Ct,Ps=Es,ws=qt("symbol-to-string-registry");Os({target:"Symbol",stat:!0,forced:!Ps},{keyFor:function(t){if(!Is(t))throw TypeError(bs(t)+" is not a symbol");if(As(ws,t))return ws[t]}});var Cs=y([].slice),Ns=kr,Ds=C,Ls=R,Us=Zn,Ms=y([].push),js=Nr,xs=ut,Ws=h,ks=M,Vs=y,Gs=c,Fs=C,Bs=Pt,Js=Cs,Ys=function(t){if(Ds(t))return t;if(Ns(t)){for(var e=t.length,r=[],n=0;n<e;n++){var o=t[n];"string"==typeof o?Ms(r,o):"number"!=typeof o&&"Number"!=Ls(o)&&"String"!=Ls(o)||Ms(r,Us(o))}var i=r.length,a=!0;return function(t,e){if(a)return a=!1,e;if(Ns(this))return e;for(var n=0;n<i;n++)if(r[n]===t)return e}}},Ks=_t,Hs=String,Qs=xs("JSON","stringify"),qs=Vs(/./.exec),Xs=Vs("".charAt),zs=Vs("".charCodeAt),$s=Vs("".replace),Zs=Vs(1..toString),tc=/[\uD800-\uDFFF]/g,ec=/^[\uD800-\uDBFF]$/,rc=/^[\uDC00-\uDFFF]$/,nc=!Ks||Gs((function(){var t=xs("Symbol")();return"[null]"!=Qs([t])||"{}"!=Qs({a:t})||"{}"!=Qs(Object(t))})),oc=Gs((function(){return'"\\udf06\\ud834"'!==Qs("\udf06\ud834")||'"\\udead"'!==Qs("\udead")})),ic=function(t,e){var r=Js(arguments),n=Ys(e);if(Fs(n)||void 0!==t&&!Bs(t))return r[1]=function(t,e){if(Fs(n)&&(e=ks(n,this,Hs(t),e)),!Bs(e))return e},Ws(Qs,null,r)},ac=function(t,e,r){var n=Xs(r,e-1),o=Xs(r,e+1);return qs(ec,t)&&!qs(rc,o)||qs(rc,t)&&!qs(ec,n)?"\\u"+Zs(zs(t,0),16):t};Qs&&js({target:"JSON",stat:!0,arity:3,forced:nc||oc},{stringify:function(t,e,r){var n=Js(arguments),o=Ws(nc?ic:Qs,null,n);return oc&&"string"==typeof o?$s(o,tc,ac):o}});var sc=ci,cc=$t;Nr({target:"Object",stat:!0,forced:!_t||c((function(){sc.f(1)}))},{getOwnPropertySymbols:function(t){var e=sc.f;return e?e(cc(t)):[]}}),_i("asyncIterator"),_i("hasInstance"),_i("isConcatSpreadable"),_i("iterator"),_i("match"),_i("matchAll"),_i("replace"),_i("search"),_i("species"),_i("split");var uc=bi;_i("toPrimitive"),uc();var pc=ut,lc=ji;_i("toStringTag"),lc(pc("Symbol"),"Symbol"),_i("unscopables"),ji(s.JSON,"JSON",!0);var fc,dc,hc,Ec=ot.Symbol,gc={},vc=D,Tc=ee,yc=Function.prototype,mc=vc&&Object.getOwnPropertyDescriptor,Sc=Tc(yc,"name"),_c={EXISTS:Sc,PROPER:Sc&&"something"===function(){}.name,CONFIGURABLE:Sc&&(!vc||vc&&mc(yc,"name").configurable)},Rc=!c((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Oc=ee,Ac=C,Ic=$t,bc=Rc,Pc=Do("IE_PROTO"),wc=Object,Cc=wc.prototype,Nc=bc?wc.getPrototypeOf:function(t){var e=Ic(t);if(Oc(e,Pc))return e[Pc];var r=e.constructor;return Ac(r)&&e instanceof r?r.prototype:e instanceof wc?Cc:null},Dc=c,Lc=C,Uc=nt,Mc=Ko,jc=Nc,xc=pi,Wc=Ee("iterator"),kc=!1;[].keys&&("next"in(hc=[].keys())?(dc=jc(jc(hc)))!==Object.prototype&&(fc=dc):kc=!0);var Vc=!Uc(fc)||Dc((function(){var t={};return fc[Wc].call(t)!==t}));Lc((fc=Vc?{}:Mc(fc))[Wc])||xc(fc,Wc,(function(){return this}));var Gc={IteratorPrototype:fc,BUGGY_SAFARI_ITERATORS:kc},Fc=Gc.IteratorPrototype,Bc=Ko,Jc=F,Yc=ji,Kc=gc,Hc=function(){return this},Qc=y,qc=Ut,Xc=C,zc=String,$c=TypeError,Zc=function(t,e,r){try{return Qc(qc(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}},tu=ir,eu=function(t){if("object"==typeof t||Xc(t))return t;throw $c("Can't set "+zc(t)+" as a prototype")},ru=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Zc(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return tu(r),eu(n),e?t(r,n):r.__proto__=n,r}}():void 0),nu=Nr,ou=M,iu=_c,au=function(t,e,r,n){var o=e+" Iterator";return t.prototype=Bc(Fc,{next:Jc(+!n,r)}),Yc(t,o,!1,!0),Kc[o]=Hc,t},su=Nc,cu=ji,uu=pi,pu=gc,lu=Gc,fu=iu.PROPER,du=lu.BUGGY_SAFARI_ITERATORS,hu=Ee("iterator"),Eu="keys",gu="values",vu="entries",Tu=function(){return this},yu=function(t,e,r,n,o,i,a){au(r,e,n);var s,c,u,p=function(t){if(t===o&&E)return E;if(!du&&t in d)return d[t];switch(t){case Eu:case gu:case vu:return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",f=!1,d=t.prototype,h=d[hu]||d["@@iterator"]||o&&d[o],E=!du&&h||p(o),g="Array"==e&&d.entries||h;if(g&&(s=su(g.call(new t)))!==Object.prototype&&s.next&&(cu(s,l,!0,!0),pu[l]=Tu),fu&&o==gu&&h&&h.name!==gu&&(f=!0,E=function(){return ou(h,this)}),o)if(c={values:p(gu),keys:i?E:p(Eu),entries:p(vu)},a)for(u in c)(du||f||!(u in d))&&uu(d,u,c[u]);else nu({target:e,proto:!0,forced:du||f},c);return a&&d[hu]!==E&&uu(d,hu,E,{name:o}),pu[e]=E,c},mu=function(t,e){return{value:t,done:e}},Su=tt,_u=gc,Ru=$i;tr.f;var Ou=yu,Au=mu,Iu="Array Iterator",bu=Ru.set,Pu=Ru.getterFor(Iu);Ou(Array,"Array",(function(t,e){bu(this,{type:Iu,target:Su(t),index:0,kind:e})}),(function(){var t=Pu(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Au(void 0,!0)):Au("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),_u.Arguments=_u.Array;var wu={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Cu=s,Nu=cn,Du=yr,Lu=gc,Uu=Ee("toStringTag");for(var Mu in wu){var ju=Cu[Mu],xu=ju&&ju.prototype;xu&&Nu(xu)!==Uu&&Du(xu,Uu,Mu),Lu[Mu]=Lu.Array}var Wu=Ec,ku=Ee,Vu=tr.f,Gu=ku("metadata"),Fu=Function.prototype;void 0===Fu[Gu]&&Vu(Fu,Gu,{value:null}),_i("dispose"),_i("metadata");var Bu=Wu;_i("asyncDispose");var Ju=y,Yu=ut("Symbol"),Ku=Yu.keyFor,Hu=Ju(Yu.prototype.valueOf),Qu=Yu.isRegisteredSymbol||function(t){try{return void 0!==Ku(Hu(t))}catch(t){return!1}};Nr({target:"Symbol",stat:!0},{isRegisteredSymbol:Qu});for(var qu=qt,Xu=ut,zu=y,$u=Pt,Zu=Ee,tp=Xu("Symbol"),ep=tp.isWellKnownSymbol,rp=Xu("Object","getOwnPropertyNames"),np=zu(tp.prototype.valueOf),op=qu("wks"),ip=0,ap=rp(tp),sp=ap.length;ip<sp;ip++)try{var cp=ap[ip];$u(tp[cp])&&Zu(cp)}catch(t){}var up=function(t){if(ep&&ep(t))return!0;try{for(var e=np(t),r=0,n=rp(op),o=n.length;r<o;r++)if(op[n[r]]==e)return!0}catch(t){}return!1};Nr({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:up}),_i("matcher"),_i("observable"),Nr({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Qu}),Nr({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:up}),_i("metadataKey"),_i("patternMatch"),_i("replaceAll");var pp=o(Bu),lp=y,fp=Br,dp=Zn,hp=z,Ep=lp("".charAt),gp=lp("".charCodeAt),vp=lp("".slice),Tp=function(t){return function(e,r){var n,o,i=dp(hp(e)),a=fp(r),s=i.length;return a<0||a>=s?t?"":void 0:(n=gp(i,a))<55296||n>56319||a+1===s||(o=gp(i,a+1))<56320||o>57343?t?Ep(i,a):n:t?vp(i,a,a+2):o-56320+(n-55296<<10)+65536}},yp={codeAt:Tp(!1),charAt:Tp(!0)}.charAt,mp=Zn,Sp=$i,_p=yu,Rp=mu,Op="String Iterator",Ap=Sp.set,Ip=Sp.getterFor(Op);_p(String,"String",(function(t){Ap(this,{type:Op,string:mp(t),index:0})}),(function(){var t,e=Ip(this),r=e.string,n=e.index;return n>=r.length?Rp(void 0,!0):(t=yp(r,n),e.index+=t.length,Rp(t,!1))}));var bp=o(di.f("iterator"));function Pp(t){return Pp="function"==typeof pp&&"symbol"==typeof bp?function(t){return typeof t}:function(t){return t&&"function"==typeof pp&&t.constructor===pp&&t!==pp.prototype?"symbol":typeof t},Pp(t)}var wp=o(di.f("toPrimitive"));function Cp(t){var e=function(t,e){if("object"!==Pp(t)||null===t)return t;var r=t[wp];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Pp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Pp(e)?e:String(e)}var Np=ot,Dp=function(t){return Np[t+"Prototype"]},Lp=Dp("Array").keys,Up=cn,Mp=ee,jp=pt,xp=Lp,Wp=Array.prototype,kp={DOMTokenList:!0,NodeList:!0},Vp=o((function(t){var e=t.keys;return t===Wp||jp(Wp,t)&&e===Wp.keys||Mp(kp,Up(t))?xp:e})),Gp=uo.includes;Nr({target:"Array",proto:!0,forced:c((function(){return!Array(1).includes()}))},{includes:function(t){return Gp(this,t,arguments.length>1?arguments[1]:void 0)}});var Fp=Dp("Array").includes,Bp=nt,Jp=R,Yp=Ee("match"),Kp=function(t){var e;return Bp(t)&&(void 0!==(e=t[Yp])?!!e:"RegExp"==Jp(t))},Hp=TypeError,Qp=Ee("match"),qp=Nr,Xp=function(t){if(Kp(t))throw Hp("The method doesn't accept regular expressions");return t},zp=z,$p=Zn,Zp=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[Qp]=!1,"/./"[t](e)}catch(t){}}return!1},tl=y("".indexOf);qp({target:"String",proto:!0,forced:!Zp("includes")},{includes:function(t){return!!~tl($p(zp(this)),$p(Xp(t)),arguments.length>1?arguments[1]:void 0)}});var el=Dp("String").includes,rl=pt,nl=Fp,ol=el,il=Array.prototype,al=String.prototype,sl=o((function(t){var e=t.includes;return t===il||rl(il,t)&&e===il.includes?nl:"string"==typeof t||t===al||rl(al,t)&&e===al.includes?ol:e})),cl=Ct,ul=TypeError,pl=ri,ll=Math.floor,fl=function(t,e){var r=t.length,n=ll(r/2);return r<8?dl(t,e):hl(t,fl(pl(t,0,n),e),fl(pl(t,n),e),e)},dl=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},hl=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,s=0;a<o||s<i;)t[a+s]=a<o&&s<i?n(e[a],r[s])<=0?e[a++]:r[s++]:a<o?e[a++]:r[s++];return t},El=fl,gl=c,vl=lt.match(/firefox\/(\d+)/i),Tl=!!vl&&+vl[1],yl=/MSIE|Trident/.test(lt),ml=lt.match(/AppleWebKit\/(\d+)\./),Sl=!!ml&&+ml[1],_l=Nr,Rl=y,Ol=Ut,Al=$t,Il=Hr,bl=function(t,e){if(!delete t[e])throw ul("Cannot delete property "+cl(e)+" of "+cl(t))},Pl=Zn,wl=c,Cl=El,Nl=function(t,e){var r=[][t];return!!r&&gl((function(){r.call(null,e||function(){return 1},1)}))},Dl=Tl,Ll=yl,Ul=Tt,Ml=Sl,jl=[],xl=Rl(jl.sort),Wl=Rl(jl.push),kl=wl((function(){jl.sort(void 0)})),Vl=wl((function(){jl.sort(null)})),Gl=Nl("sort"),Fl=!wl((function(){if(Ul)return Ul<70;if(!(Dl&&Dl>3)){if(Ll)return!0;if(Ml)return Ml<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)jl.push({k:e+n,v:r})}for(jl.sort((function(t,e){return e.v-t.v})),n=0;n<jl.length;n++)e=jl[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}}));_l({target:"Array",proto:!0,forced:kl||!Vl||!Gl||!Fl},{sort:function(t){void 0!==t&&Ol(t);var e=Al(this);if(Fl)return void 0===t?xl(e):xl(e,t);var r,n,o=[],i=Il(e);for(n=0;n<i;n++)n in e&&Wl(o,e[n]);for(Cl(o,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:Pl(e)>Pl(r)?1:-1}}(t)),r=Il(o),n=0;n<r;)e[n]=o[n++];for(;n<i;)bl(e,n++);return e}});var Bl=Dp("Array").sort,Jl=pt,Yl=Bl,Kl=Array.prototype,Hl=o((function(t){var e=t.sort;return t===Kl||Jl(Kl,t)&&e===Kl.sort?Yl:e})),Ql=ut,ql=Ho,Xl=ci,zl=ir,$l=y([].concat),Zl=Ql("Reflect","ownKeys")||function(t){var e=ql.f(zl(t)),r=Xl.f;return r?$l(e,r(t)):e},tf=ee,ef=Zl,rf=N,nf=tr,of=nt,af=yr,sf=Error,cf=y("".replace),uf=String(sf("zxcasd").stack),pf=/\n\s*at [^:]*:[^\n]*/,lf=pf.test(uf),ff=F,df=!c((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",ff(1,7)),7!==t.stack)})),hf=yr,Ef=function(t,e){if(lf&&"string"==typeof t&&!sf.prepareStackTrace)for(;e--;)t=cf(t,pf,"");return t},gf=df,vf=Error.captureStackTrace,Tf=gc,yf=Ee("iterator"),mf=Array.prototype,Sf=cn,_f=xt,Rf=Q,Of=gc,Af=Ee("iterator"),If=function(t){if(!Rf(t))return _f(t,Af)||_f(t,"@@iterator")||Of[Sf(t)]},bf=M,Pf=Ut,wf=ir,Cf=Ct,Nf=If,Df=TypeError,Lf=M,Uf=ir,Mf=xt,jf=Ze,xf=M,Wf=ir,kf=Ct,Vf=function(t){return void 0!==t&&(Tf.Array===t||mf[yf]===t)},Gf=Hr,Ff=pt,Bf=function(t,e){var r=arguments.length<2?Nf(t):e;if(Pf(r))return wf(bf(r,t));throw Df(Cf(t)+" is not iterable")},Jf=If,Yf=function(t,e,r){var n,o;Uf(t);try{if(!(n=Mf(t,"return"))){if("throw"===e)throw r;return r}n=Lf(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return Uf(n),r},Kf=TypeError,Hf=function(t,e){this.stopped=t,this.result=e},Qf=Hf.prototype,qf=function(t,e,r){var n,o,i,a,s,c,u,p=r&&r.that,l=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),d=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),E=jf(e,p),g=function(t){return n&&Yf(n,"normal",t),new Hf(!0,t)},v=function(t){return l?(Wf(t),h?E(t[0],t[1],g):E(t[0],t[1])):h?E(t,g):E(t)};if(f)n=t.iterator;else if(d)n=t;else{if(!(o=Jf(t)))throw Kf(kf(t)+" is not iterable");if(Vf(o)){for(i=0,a=Gf(t);a>i;i++)if((s=v(t[i]))&&Ff(Qf,s))return s;return new Hf(!1)}n=Bf(t,o)}for(c=f?t.next:n.next;!(u=xf(c,n)).done;){try{s=v(u.value)}catch(t){Yf(n,"throw",t)}if("object"==typeof s&&s&&Ff(Qf,s))return s}return new Hf(!1)},Xf=Zn,zf=Nr,$f=pt,Zf=Nc,td=ru,ed=function(t,e,r){for(var n=ef(e),o=nf.f,i=rf.f,a=0;a<n.length;a++){var s=n[a];tf(t,s)||r&&tf(r,s)||o(t,s,i(e,s))}},rd=Ko,nd=yr,od=F,id=function(t,e){of(e)&&"cause"in e&&af(t,"cause",e.cause)},ad=function(t,e,r,n){gf&&(vf?vf(t,e):hf(t,"stack",Ef(r,n)))},sd=qf,cd=function(t,e){return void 0===t?arguments.length<2?"":e:Xf(t)},ud=Ee("toStringTag"),pd=Error,ld=[].push,fd=function(t,e){var r,n=$f(dd,this);td?r=td(pd(),n?Zf(this):dd):(r=n?this:rd(dd),nd(r,ud,"Error")),void 0!==e&&nd(r,"message",cd(e)),ad(r,fd,r.stack,1),arguments.length>2&&id(r,arguments[2]);var o=[];return sd(t,ld,{that:o}),nd(r,"errors",o),r};td?td(fd,pd):ed(fd,pd,{name:!0});var dd=fd.prototype=rd(pd.prototype,{constructor:od(1,fd),message:od(1,""),name:od(1,"AggregateError")});zf({global:!0,constructor:!0,arity:2},{AggregateError:fd});var hd,Ed,gd,vd,Td="undefined"!=typeof process&&"process"==R(process),yd=ut,md=fi,Sd=D,_d=Ee("species"),Rd=pt,Od=TypeError,Ad=In,Id=Ct,bd=TypeError,Pd=ir,wd=function(t){if(Ad(t))return t;throw bd(Id(t)+" is not a constructor")},Cd=Q,Nd=Ee("species"),Dd=function(t,e){var r,n=Pd(t).constructor;return void 0===n||Cd(r=Pd(n)[Nd])?e:wd(r)},Ld=TypeError,Ud=/(?:ipad|iphone|ipod).*applewebkit/i.test(lt),Md=s,jd=h,xd=Ze,Wd=C,kd=ee,Vd=c,Gd=wo,Fd=Cs,Bd=we,Jd=function(t,e){if(t<e)throw Ld("Not enough arguments");return t},Yd=Ud,Kd=Td,Hd=Md.setImmediate,Qd=Md.clearImmediate,qd=Md.process,Xd=Md.Dispatch,zd=Md.Function,$d=Md.MessageChannel,Zd=Md.String,th=0,eh={},rh="onreadystatechange";Vd((function(){hd=Md.location}));var nh=function(t){if(kd(eh,t)){var e=eh[t];delete eh[t],e()}},oh=function(t){return function(){nh(t)}},ih=function(t){nh(t.data)},ah=function(t){Md.postMessage(Zd(t),hd.protocol+"//"+hd.host)};Hd&&Qd||(Hd=function(t){Jd(arguments.length,1);var e=Wd(t)?t:zd(t),r=Fd(arguments,1);return eh[++th]=function(){jd(e,void 0,r)},Ed(th),th},Qd=function(t){delete eh[t]},Kd?Ed=function(t){qd.nextTick(oh(t))}:Xd&&Xd.now?Ed=function(t){Xd.now(oh(t))}:$d&&!Yd?(vd=(gd=new $d).port2,gd.port1.onmessage=ih,Ed=xd(vd.postMessage,vd)):Md.addEventListener&&Wd(Md.postMessage)&&!Md.importScripts&&hd&&"file:"!==hd.protocol&&!Vd(ah)?(Ed=ah,Md.addEventListener("message",ih,!1)):Ed=rh in Bd("script")?function(t){Gd.appendChild(Bd("script"))[rh]=function(){Gd.removeChild(this),nh(t)}}:function(t){setTimeout(oh(t),0)});var sh={set:Hd,clear:Qd},ch=function(){this.head=null,this.tail=null};ch.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var uh,ph,lh,fh,dh,hh=ch,Eh=/ipad|iphone|ipod/i.test(lt)&&"undefined"!=typeof Pebble,gh=/web0s(?!.*chrome)/i.test(lt),vh=s,Th=Ze,yh=N.f,mh=sh.set,Sh=hh,_h=Ud,Rh=Eh,Oh=gh,Ah=Td,Ih=vh.MutationObserver||vh.WebKitMutationObserver,bh=vh.document,Ph=vh.process,wh=vh.Promise,Ch=yh(vh,"queueMicrotask"),Nh=Ch&&Ch.value;if(!Nh){var Dh=new Sh,Lh=function(){var t,e;for(Ah&&(t=Ph.domain)&&t.exit();e=Dh.get();)try{e()}catch(t){throw Dh.head&&uh(),t}t&&t.enter()};_h||Ah||Oh||!Ih||!bh?!Rh&&wh&&wh.resolve?((fh=wh.resolve(void 0)).constructor=wh,dh=Th(fh.then,fh),uh=function(){dh(Lh)}):Ah?uh=function(){Ph.nextTick(Lh)}:(mh=Th(mh,vh),uh=function(){mh(Lh)}):(ph=!0,lh=bh.createTextNode(""),new Ih(Lh).observe(lh,{characterData:!0}),uh=function(){lh.data=ph=!ph}),Nh=function(t){Dh.head||uh(),Dh.add(t)}}var Uh=Nh,Mh=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},jh=s.Promise,xh="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Wh=!xh&&!Td&&"object"==typeof window&&"object"==typeof document,kh=s,Vh=jh,Gh=C,Fh=qe,Bh=fn,Jh=Ee,Yh=Wh,Kh=xh,Hh=Tt,Qh=Vh&&Vh.prototype,qh=Jh("species"),Xh=!1,zh=Gh(kh.PromiseRejectionEvent),$h=Fh("Promise",(function(){var t=Bh(Vh),e=t!==String(Vh);if(!e&&66===Hh)return!0;if(!Qh.catch||!Qh.finally)return!0;if(!Hh||Hh<51||!/native code/.test(t)){var r=new Vh((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[qh]=n,!(Xh=r.then((function(){}))instanceof n))return!0}return!e&&(Yh||Kh)&&!zh})),Zh={CONSTRUCTOR:$h,REJECTION_EVENT:zh,SUBCLASSING:Xh},tE={},eE=Ut,rE=TypeError,nE=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw rE("Bad Promise constructor");e=t,r=n})),this.resolve=eE(e),this.reject=eE(r)};tE.f=function(t){return new nE(t)};var oE,iE,aE=Nr,sE=Td,cE=s,uE=M,pE=pi,lE=ji,fE=function(t){var e=yd(t);Sd&&e&&!e[_d]&&md(e,_d,{configurable:!0,get:function(){return this}})},dE=Ut,hE=C,EE=nt,gE=function(t,e){if(Rd(e,t))return t;throw Od("Incorrect invocation")},vE=Dd,TE=sh.set,yE=Uh,mE=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}},SE=Mh,_E=hh,RE=$i,OE=jh,AE=Zh,IE=tE,bE="Promise",PE=AE.CONSTRUCTOR,wE=AE.REJECTION_EVENT,CE=RE.getterFor(bE),NE=RE.set,DE=OE&&OE.prototype,LE=OE,UE=DE,ME=cE.TypeError,jE=cE.document,xE=cE.process,WE=IE.f,kE=WE,VE=!!(jE&&jE.createEvent&&cE.dispatchEvent),GE="unhandledrejection",FE=function(t){var e;return!(!EE(t)||!hE(e=t.then))&&e},BE=function(t,e){var r,n,o,i=e.value,a=1==e.state,s=a?t.ok:t.fail,c=t.resolve,u=t.reject,p=t.domain;try{s?(a||(2===e.rejection&&QE(e),e.rejection=1),!0===s?r=i:(p&&p.enter(),r=s(i),p&&(p.exit(),o=!0)),r===t.promise?u(ME("Promise-chain cycle")):(n=FE(r))?uE(n,r,c,u):c(r)):u(i)}catch(t){p&&!o&&p.exit(),u(t)}},JE=function(t,e){t.notified||(t.notified=!0,yE((function(){for(var r,n=t.reactions;r=n.get();)BE(r,t);t.notified=!1,e&&!t.rejection&&KE(t)})))},YE=function(t,e,r){var n,o;VE?((n=jE.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),cE.dispatchEvent(n)):n={promise:e,reason:r},!wE&&(o=cE["on"+t])?o(n):t===GE&&mE("Unhandled promise rejection",r)},KE=function(t){uE(TE,cE,(function(){var e,r=t.facade,n=t.value;if(HE(t)&&(e=SE((function(){sE?xE.emit("unhandledRejection",n,r):YE(GE,r,n)})),t.rejection=sE||HE(t)?2:1,e.error))throw e.value}))},HE=function(t){return 1!==t.rejection&&!t.parent},QE=function(t){uE(TE,cE,(function(){var e=t.facade;sE?xE.emit("rejectionHandled",e):YE("rejectionhandled",e,t.value)}))},qE=function(t,e,r){return function(n){t(e,n,r)}},XE=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,JE(t,!0))},zE=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw ME("Promise can't be resolved itself");var n=FE(e);n?yE((function(){var r={done:!1};try{uE(n,e,qE(zE,r,t),qE(XE,r,t))}catch(e){XE(r,e,t)}})):(t.value=e,t.state=1,JE(t,!1))}catch(e){XE({done:!1},e,t)}}};PE&&(UE=(LE=function(t){gE(this,UE),dE(t),uE(oE,this);var e=CE(this);try{t(qE(zE,e),qE(XE,e))}catch(t){XE(e,t)}}).prototype,(oE=function(t){NE(this,{type:bE,done:!1,notified:!1,parent:!1,reactions:new _E,rejection:!1,state:0,value:void 0})}).prototype=pE(UE,"then",(function(t,e){var r=CE(this),n=WE(vE(this,LE));return r.parent=!0,n.ok=!hE(t)||t,n.fail=hE(e)&&e,n.domain=sE?xE.domain:void 0,0==r.state?r.reactions.add(n):yE((function(){BE(n,r)})),n.promise})),iE=function(){var t=new oE,e=CE(t);this.promise=t,this.resolve=qE(zE,e),this.reject=qE(XE,e)},IE.f=WE=function(t){return t===LE||undefined===t?new iE(t):kE(t)}),aE({global:!0,constructor:!0,wrap:!0,forced:PE},{Promise:LE}),lE(LE,bE,!1,!0),fE(bE);var $E=Ee("iterator"),ZE=!1;try{var tg=0,eg={next:function(){return{done:!!tg++}},return:function(){ZE=!0}};eg[$E]=function(){return this},Array.from(eg,(function(){throw 2}))}catch(t){}var rg=jh,ng=function(t,e){if(!e&&!ZE)return!1;var r=!1;try{var n={};n[$E]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},og=Zh.CONSTRUCTOR||!ng((function(t){rg.all(t).then(void 0,(function(){}))})),ig=M,ag=Ut,sg=tE,cg=Mh,ug=qf;Nr({target:"Promise",stat:!0,forced:og},{all:function(t){var e=this,r=sg.f(e),n=r.resolve,o=r.reject,i=cg((function(){var r=ag(e.resolve),i=[],a=0,s=1;ug(t,(function(t){var c=a++,u=!1;s++,ig(r,e,t).then((function(t){u||(u=!0,i[c]=t,--s||n(i))}),o)})),--s||n(i)}));return i.error&&o(i.value),r.promise}});var pg=Nr,lg=Zh.CONSTRUCTOR;jh&&jh.prototype,pg({target:"Promise",proto:!0,forced:lg,real:!0},{catch:function(t){return this.then(void 0,t)}});var fg=M,dg=Ut,hg=tE,Eg=Mh,gg=qf;Nr({target:"Promise",stat:!0,forced:og},{race:function(t){var e=this,r=hg.f(e),n=r.reject,o=Eg((function(){var o=dg(e.resolve);gg(t,(function(t){fg(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var vg=M,Tg=tE;Nr({target:"Promise",stat:!0,forced:Zh.CONSTRUCTOR},{reject:function(t){var e=Tg.f(this);return vg(e.reject,void 0,t),e.promise}});var yg=ir,mg=nt,Sg=tE,_g=function(t,e){if(yg(t),mg(e)&&e.constructor===t)return e;var r=Sg.f(t);return(0,r.resolve)(e),r.promise},Rg=Nr,Og=jh,Ag=Zh.CONSTRUCTOR,Ig=_g,bg=ut("Promise"),Pg=!Ag;Rg({target:"Promise",stat:!0,forced:true},{resolve:function(t){return Ig(Pg&&this===bg?Og:this,t)}});var wg=M,Cg=Ut,Ng=tE,Dg=Mh,Lg=qf;Nr({target:"Promise",stat:!0,forced:og},{allSettled:function(t){var e=this,r=Ng.f(e),n=r.resolve,o=r.reject,i=Dg((function(){var r=Cg(e.resolve),o=[],i=0,a=1;Lg(t,(function(t){var s=i++,c=!1;a++,wg(r,e,t).then((function(t){c||(c=!0,o[s]={status:"fulfilled",value:t},--a||n(o))}),(function(t){c||(c=!0,o[s]={status:"rejected",reason:t},--a||n(o))}))})),--a||n(o)}));return i.error&&o(i.value),r.promise}});var Ug=M,Mg=Ut,jg=ut,xg=tE,Wg=Mh,kg=qf,Vg="No one promise resolved";Nr({target:"Promise",stat:!0,forced:og},{any:function(t){var e=this,r=jg("AggregateError"),n=xg.f(e),o=n.resolve,i=n.reject,a=Wg((function(){var n=Mg(e.resolve),a=[],s=0,c=1,u=!1;kg(t,(function(t){var p=s++,l=!1;c++,Ug(n,e,t).then((function(t){l||u||(u=!0,o(t))}),(function(t){l||u||(l=!0,a[p]=t,--c||i(new r(a,Vg)))}))})),--c||i(new r(a,Vg))}));return a.error&&i(a.value),n.promise}});var Gg=Nr,Fg=jh,Bg=c,Jg=ut,Yg=C,Kg=Dd,Hg=_g,Qg=Fg&&Fg.prototype;Gg({target:"Promise",proto:!0,real:!0,forced:!!Fg&&Bg((function(){Qg.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=Kg(this,Jg("Promise")),r=Yg(t);return this.then(r?function(r){return Hg(e,t()).then((function(){return r}))}:t,r?function(r){return Hg(e,t()).then((function(){throw r}))}:t)}});var qg=o(ot.Promise);class Xg extends e.EventEmitter{reportLogUploadError(t){this.emit("REPORT_LOG_UPLOAD",t)}}const zg=new Xg;class $g{constructor(t){this.logger=void 0,this.prefixLists=[],this.logger=t}debug(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.debug(...this.prefixLists,...e)}info(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.info(...this.prefixLists,...e)}warning(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.warning(...this.prefixLists,...e)}error(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.error(...this.prefixLists,...e)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function Zg(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}function tv(){const t=new Date,e=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return e?(null==e?void 0:e[0])+":"+t.getUTCMilliseconds():t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const ev={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},rv=Date.now(),nv=t=>{for(const e in ev)if(Object.prototype.hasOwnProperty.call(ev,e)&&ev[e]===t)return e;return"DEFAULT"};class ov{constructor(){this.proxyServerURL=void 0,this.logLevel=ev.DEBUG,this.uploadState="collecting",this.uploadLogWaitingList=[],this.uploadLogUploadingList=[],this.uploadErrorCount=0,this.currentLogID=0,this.url=void 0,this.extLog=(t,e)=>{this.appendLogToWaitingList(t,...e)}}debug(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[ev.DEBUG].concat(e);this.log.apply(this,n)}info(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[ev.INFO].concat(e);this.log.apply(this,n)}warning(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[ev.WARNING].concat(e);this.log.apply(this,n)}warn(){this.warning(...arguments)}error(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[ev.ERROR].concat(e);this.log.apply(this,n)}upload(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[ev.DEBUG].concat(e);this.uploadLog.apply(this,n)}setLogLevel(t){t=Math.min(Math.max(0,t),4),this.logLevel=t}enableLogUpload(){e.setParameter("UPLOAD_LOG",!0)}disableLogUpload(){e.setParameter("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(t){this.proxyServerURL=t}prefix(t){return new $g(this).prefix(t)}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(Date.now()-rv<100)return void setTimeout((()=>{this.log(...r)}),Date.now()-rv);const o=Math.max(0,Math.min(4,r[0]));if(r[0]=Zg()+" Agora-SDK [".concat(nv(o),"]:"),this.appendLogToWaitingList(o,...r),o<this.logLevel)return;const i=Zg()+" %cAgora-SDK [".concat(nv(o),"]:");let a=[];if(!e.getParameter("USE_NEW_LOG"))switch(o){case ev.DEBUG:a=[i,"color: #64B5F6;"].concat(r.slice(1)),console.log.apply(console,a);break;case ev.INFO:a=[i,"color: #1E88E5; font-weight: bold;"].concat(r.slice(1)),console.log.apply(console,a);break;case ev.WARNING:a=[i,"color: #FB8C00; font-weight: bold;"].concat(r.slice(1)),console.warn.apply(console,a);break;case ev.ERROR:a=[i,"color: #B00020; font-weight: bold;"].concat(r.slice(1)),console.error.apply(console,a)}}uploadLog(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(Date.now()-rv<100)return void setTimeout((()=>{this.uploadLog(...e)}),Date.now()-rv);const n=Math.max(0,Math.min(4,e[0]));e[0]=Zg()+" Agora-SDK [".concat(nv(n),"]:"),this.appendLogToWaitingList(n,...e)}appendLogToWaitingList(t){if(!e.getParameter("UPLOAD_LOG"))return;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];Array.isArray(n[0])?n[0][0]=tv()+" Agora-SDK [".concat(nv(t),"]:"):n[0]=tv()+" Agora-SDK [".concat(nv(t),"]:");let i="";n.forEach((t=>{"object"==typeof t&&(t=JSON.stringify(t)),i+="".concat(t," ")})),this.uploadLogWaitingList.push({payload_str:i,log_level:t,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const t=this.uploadLogUploadingList,n={sdk_version:e.VERSION,process_id:e.getParameter("PROCESS_ID"),payload:JSON.stringify(t)};return e.retryable((async()=>{const t=await r.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(e.getParameter("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(e.getParameter("LOG_UPLOAD_SERVER"),"/upload/v1")),n,{responseType:"text"});if("OK"!==t.data){const e=new Error("unexpected upload log response");throw e.response=t,e}}),(()=>(this.uploadLogUploadingList=[],!1)),(t=>(t.response?zg.reportLogUploadError({status:t.response.status,data:t.response.data,headers:t.response.headers,message:t.message}):t.request?zg.reportLogUploadError({status:t.request.status,message:t.message}):zg.reportLogUploadError({status:-1,message:t.message}),!0)),{timeout:e.getParameter("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:e.getParameter("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,e.getParameter("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),e.getParameter("UPLOAD_LOG_INTERVAL"))})).catch((t=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),e.getParameter("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),e.getParameter("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}}const iv=new ov;var av,sv;t.LOG_UPLOAD_STATE=void 0,(av=t.LOG_UPLOAD_STATE||(t.LOG_UPLOAD_STATE={})).FREE="free",av.UPLOADING="uploading",t.LOG_TYPE=void 0,(sv=t.LOG_TYPE||(t.LOG_TYPE={}))[sv.MISC=0]="MISC",sv[sv.INTERNAL_EVENT=1]="INTERNAL_EVENT",sv[sv.PUBLIC_EVENT=2]="PUBLIC_EVENT",sv[sv.WEB_EVENT=3]="WEB_EVENT",sv[sv.INTERNAL_API=4]="INTERNAL_API",sv[sv.WEB_API=5]="WEB_API",sv[sv.PUBLIC_API=6]="PUBLIC_API";const cv={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var uv,pv,lv;function fv(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function dv(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?fv(Object(r),!0).forEach((function(e){var n,o,i;n=t,o=e,i=r[e],(o=Cp(o))in n?xr(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fv(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}t.AgoraRTCEvent=void 0,(uv=t.AgoraRTCEvent||(t.AgoraRTCEvent={})).PUBLISH="publish",uv.SUBSCRIBE="subscribe",uv.WS_COMPRESSOR_INIT="ws_compressor_init",uv.SESSION_INIT="session_init",uv.JOIN_CHOOSE_SERVER="join_choose_server",uv.REQ_USER_ACCOUNT="req_user_account",uv.JOIN_GATEWAY="join_gateway",uv.REJOIN_GATEWAY="rejoin_gateway",uv.STREAM_SWITCH="stream_switch",uv.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",uv.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",uv.FIRST_VIDEO_RECEIVED="first_video_received",uv.FIRST_AUDIO_RECEIVED="first_audio_received",uv.FIRST_VIDEO_DECODE="first_video_decode",uv.FIRST_AUDIO_DECODE="first_audio_decode",uv.ON_ADD_AUDIO_STREAM="on_add_audio_stream",uv.ON_ADD_VIDEO_STREAM="on_add_video_stream",uv.ON_UPDATE_STREAM="on_update_stream",uv.ON_REMOVE_STREAM="on_remove_stream",uv.USER_ANALYTICS="req_user_analytics",uv.PC_STATS="pc_stats",uv.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",t.AgoraRTCEventUploadType=void 0,(pv=t.AgoraRTCEventUploadType||(t.AgoraRTCEventUploadType={})).SESSION="io.agora.pb.Wrtc.Session",pv.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",pv.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",pv.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",pv.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",pv.PUBLISH="io.agora.pb.Wrtc.Publish",pv.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",pv.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",pv.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",pv.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",pv.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",pv.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",pv.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",pv.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",pv.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",pv.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",pv.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",pv.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",pv.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",pv.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",pv.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",pv.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",pv.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",pv.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",pv.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",pv.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",pv.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",pv.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",pv.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",pv.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",pv.PC_STATS="io.agora.pb.Wrtc.PCStats",pv.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",t.AgoraEventUploadId=void 0,(lv=t.AgoraEventUploadId||(t.AgoraEventUploadId={}))[lv.WORKER_EVENT=156]="WORKER_EVENT",lv[lv.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t.EventNameToID=void 0,function(t){t[t.SESSION=26]="SESSION",t[t.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",t[t.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",t[t.JOIN_GATEWAY=28]="JOIN_GATEWAY",t[t.PUBLISH=30]="PUBLISH",t[t.SUBSCRIBE=29]="SUBSCRIBE",t[t.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",t[t.STREAM_SWITCH=32]="STREAM_SWITCH",t[t.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",t[t.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",t[t.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",t[t.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",t[t.API_INVOKE=41]="API_INVOKE",t[t.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",t[t.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",t[t.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",t[t.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",t[t.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",t[t.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",t[t.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",t[t.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",t[t.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",t[t.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t[t.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",t[t.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",t[t.USER_ANALYTICS=1e4]="USER_ANALYTICS",t[t.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(t.EventNameToID||(t.EventNameToID={}));class hv{constructor(){this.baseInfoMap=new Map,this.proxyServer=void 0,this.eventUploadTimer=void 0,this.setSessionIdTimer=void 0,this.url=void 0,this.backupUrl=void 0,this._appId=void 0,this.keyEventUploadPendingItems=[],this.normalEventUploadPendingItems=[],this.apiInvokeUploadPendingItems=[],this.apiInvokeCount=0,this.ltsList=[],this.lastSendNormalEventTime=Date.now(),this.customReportCounterTimer=void 0,this.customReportCount=0,this.extApiInvoke=async t=>{for(const r of t){const t=dv(dv({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:e.AgoraAPITag.TRACER});this.sendApiInvoke(t)}},this.eventUploadTimer=window.setInterval(this.doSend.bind(this),e.getParameter("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),e.getParameter("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return void iv.error("adjust session ".concat(t," start time, sid is not exist or info is undefined"));const e=this.baseInfoMap.get(t),r=Date.now(),n=e.startTime;e.startTime=r,iv.debug("rewrite session ".concat(t," startTime: ").concat(r," , ").concat(r-n,"ms")),this.baseInfoMap.set(t,e)}setAppId(t){this._appId=t}reportApiInvoke(t,r,n){r.timeout=r.timeout||6e4,r.reportResult=void 0===r.reportResult||r.reportResult;const o=Date.now();this.apiInvokeCount+=1;const i=this.apiInvokeCount,a=()=>({tag:r.tag,invokeId:i,sid:t,name:r.name,apiInvokeTime:o,options:r.options,states:r.states||null}),s=!!e.getParameter("SHOW_REPORT_INVOKER_LOG");s&&iv.info("".concat(r.name," start"),r.options);let c=!1;e.wait(r.timeout).then((()=>{c||(this.sendApiInvoke(dv(dv({},a()),{},{error:e.AgoraRTCErrorCode.API_INVOKE_TIMEOUT,success:!1})),iv.debug("".concat(r.name," timeout")))}));const u=new e.AgoraRTCError(e.AgoraRTCErrorCode.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:t=>{const o=()=>{if(c)throw u;return c=!0,this.sendApiInvoke(dv(dv({},a()),{},{success:!0},r.reportResult&&{result:t})),s&&iv.info("".concat(r.name," onSuccess")),t};return n?e.throttleByKey(o,r.name+"Success",n,(()=>c=!0)):o()},onError:t=>{const o=()=>{if(c)throw t;c=!0,this.sendApiInvoke(dv(dv({},a()),{},{success:!1,error:t})),s&&iv.info("".concat(r.name," onFailure"),t.toString())};return n?e.throttleByKey(o,r.name+"Error",n,(()=>c=!0)):o()}}}sessionInit(r,n){if(this.baseInfoMap.has(r))return;const o=Date.now(),i=this.createBaseInfo(r,o);i.cname=n.cname;const a=Object.assign({},{willUploadConsoleLog:e.getParameter("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:e.IS_GLOBAL_VERSION?"global":"oversea",areas:e.getParameter("AREAS")&&e.getParameter("AREAS").join(",")},n.extend),{stringUid:s,channelProfile:c,channelMode:u,isABTestSuccess:p,lsid:l,clientRole:f}=n,d=Date.now(),h=dv(dv({},i),{},{eventType:t.AgoraRTCEvent.SESSION_INIT,appid:n.appid,browser:navigator.userAgent,build:e.BUILD,lts:d,elapse:d-o,extend:JSON.stringify(a),mode:n.mode,process:e.getParameter("PROCESS_ID"),appType:e.getParameter("APP_TYPE"),success:!0,version:e.VERSION,stringUid:s,channelProfile:c,channelMode:u,isABTestSuccess:p,lsid:l,clientType:20,clientRole:f,serviceId:e.getParameter("PROCESS_ID"),extensionID:e.getParameter("PLUGIN_INFO").join(",")||""});this.send({type:t.AgoraRTCEventUploadType.SESSION,data:h},!0)}joinChooseServer(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.JOIN_CHOOSE_SERVER,lts:i,eventElapse:i-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:i-n.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3});this.send({type:t.AgoraRTCEventUploadType.JOIN_CHOOSE_SERVER,data:a},!0)}reqUserAccount(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.REQ_USER_ACCOUNT,lts:i,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:i-n.startTime,eventElapse:i-r.lts,extend:JSON.stringify(r.extend)});this.send({type:t.AgoraRTCEventUploadType.REQ_USER_ACCOUNT,data:a},!0)}joinGateway(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info;r.vid&&(o.vid=r.vid),o.uid=r.uid,o.cid=r.cid;const i=Date.now(),{firstSuccess:a,avoidJoinStartTime:s,isProxy:c,addr:u}=r,p=i-(a&&s?s:n.startTime),l=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.JOIN_GATEWAY,lts:i,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,elapse:p,eventElapse:i-r.lts,firstSuccess:a,signalChannel:r.signalChannel}),f=l.success?1:0;if(r.succ&&(n.lastJoinSuccessTime=i),a)this.send({type:t.AgoraRTCEventUploadType.JOIN_GATEWAY,data:l},!0);else{let e;if(u)if(c){const t=u.match(/h=(\d{1,3}-){3}\d{1,3}/g),r=u.match(/p=[0-9]{1,6}/g);e={isSuccess:f,gatewayIp:t&&t.length?t[0].split("=")[1].replace(/-/g,"."):"",port:r&&r.length?r[0].split("=")[1]:"",isProxy:c?1:0}}else{const t=u.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),r=u.match(/(:|p=)[0-9]{1,6}/g);e={isSuccess:f,gatewayIp:t&&t.length?t[0].split("//")[1].replace(/-/g,"."):"",port:r&&r.length?r[0].split(/:|p=/g)[1]:"",isProxy:c?1:0}}else e={isSuccess:f,gatewayIp:"",port:"",isProxy:c?1:0};delete l.success,delete l.eventType,delete l.firstSuccess,l.vid=Number(l.vid);const r=Object.assign({},l,e,{eventType:t.AgoraRTCEvent.REJOIN_GATEWAY});this.send({type:t.AgoraRTCEventUploadType.RE_JOIN_GATEWAY,data:r},!0)}}joinChannelTimeout(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=Date.now(),i=dv(dv({},n.info),{},{lts:o,timeout:r,elapse:o-n.startTime});this.send({type:t.AgoraRTCEventUploadType.JOIN_CHANNEL_TIMEOUT,data:i},!0)}publish(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.PUBLISH,lts:i,eventElapse:r.eventElapse,elapse:i-n.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:t.AgoraRTCEventUploadType.PUBLISH,data:a},!0)}subscribe(e,r,n){const o=this.baseInfoMap.get(e);if(!o)return;const i=o.info,a=Date.now(),s=dv(dv({},i),{},{eventType:t.AgoraRTCEvent.SUBSCRIBE,lts:a,eventElapse:r.eventElapse,elapse:a-o.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof r.peerid?s.peerSuid=r.peerid:s.peer=r.peerid,this.send({type:t.AgoraRTCEventUploadType.SUBSCRIBE,data:s},!0)}wsCompressorInit(e){var r;const n=[...Vp(r=this.baseInfoMap).call(r)],o=n.length?n[0]:"UnableToGetSid",i=this.baseInfoMap.get(o);if(!i)return;const a=i.info,s=Date.now(),c=dv(dv({},a),{},{eventType:t.AgoraRTCEvent.WS_COMPRESSOR_INIT,lts:s,eventElapse:e.eventElapse,elapse:s-i.startTime,status:e.status?1:2});this.send({type:t.AgoraRTCEventUploadType.WS_COMPRESSOR_INIT,data:c},!0)}firstRemoteVideoDecode(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=dv(dv(dv({},i),n),{},{elapse:a-o.startTime,eventType:e,lts:a,firstDecodeFrame:Math.max(a-o.startTime,0),apEnd:Math.max(n.apEnd-o.startTime,0),apStart:Math.max(n.apStart-o.startTime,0),joinGwEnd:Math.max(n.joinGwEnd-o.startTime,0),joinGwStart:Math.max(n.joinGwStart-o.startTime,0),pcEnd:Math.max(n.pcEnd-o.startTime,0),pcStart:Math.max(n.pcStart-o.startTime,0),subscriberEnd:Math.max(n.subscriberEnd-o.startTime,0),subscriberStart:Math.max(n.subscriberStart-o.startTime,0),videoAddNotify:Math.max(n.videoAddNotify-o.startTime,0)});this.send({type:r,data:s},!0)}firstRemoteFrame(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=dv(dv(dv({},i),n),{},{elapse:a-o.startTime,eventType:e,lts:a});this.send({type:r,data:s},!0)}pcStats(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv(dv({},o),r),{},{vid:void 0===o.vid?0:Number(o.vid),elapse:i-n.startTime,eventType:t.AgoraRTCEvent.PC_STATS,lts:i});this.send({type:t.AgoraRTCEventUploadType.PC_STATS,data:a},!0)}updateRemoteRTPCapabilities(e,r){if(e){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv(dv({},o),r),{},{vid:void 0===o.vid?0:Number(o.vid),eventType:t.AgoraRTCEvent.UPDATE_REMOTE_RTPCAPABILITIES,lts:i});this.send({type:t.AgoraRTCEventUploadType.UPDATE_REMOTE_RTPCAPABILITIES,data:a},!0)}}onGatewayStream(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=dv(dv(dv({},i),n),{},{eventType:e,lts:a});this.send({type:r,data:s},!0)}streamSwitch(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.STREAM_SWITCH,lts:i,isDual:r.isdual,elapse:i-n.startTime,success:r.succ});this.send({type:t.AgoraRTCEventUploadType.STREAM_SWITCH,data:a},!0)}requestProxyAppCenter(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.REQUEST_PROXY_APPCENTER,lts:i,eventElapse:i-r.lts,elapse:i-n.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:t.AgoraRTCEventUploadType.REQUEST_PROXY_APPCENTER,data:a},!0)}requestProxyWorkerManager(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{eventType:t.AgoraRTCEvent.REQUEST_PROXY_WORKER_MANAGER,lts:i,eventElapse:i-r.lts,elapse:i-n.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:t.AgoraRTCEventUploadType.REQUEST_PROXY_WORKER_MANAGER,data:a},!0)}setProxyServer(t){this.proxyServer=t,t?iv.debug("reportProxyServerurl: ".concat(t)):iv.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv({},o),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:i,elapse:i-n.startTime,joinChannelSuccessElapse:i-(n.lastJoinSuccessTime||i),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:t.AgoraRTCEventUploadType.PEER_PUBLISH_STATUS,data:a},!0)}workerEvent(r,n){const o=this.baseInfoMap.get(r);if(!o)return;const i=o.info,a=Date.now(),s=dv(dv(dv({},i),n),{},{elapse:a-o.startTime,lts:a,productType:"WebRTC"});e.dividePackage(s,"payload",1300).forEach((e=>this.send({type:t.AgoraRTCEventUploadType.WORKER_EVENT,data:e},!0)))}apworkerEvent(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv(dv({},o),r),{},{elapse:i-n.startTime,lts:i});this.send({type:t.AgoraRTCEventUploadType.AP_WORKER_EVENT,data:a},!0)}joinWebProxyAP(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv(dv({},o),r),{},{elapse:i-n.startTime,lts:i,extend:r.extend||void 0});this.send({type:t.AgoraRTCEventUploadType.JOIN_WEB_PROXY_AP,data:a},!0)}WebSocketQuit(e,r){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,i=Date.now(),a=dv(dv(dv({},o),r),{},{elapse:i-n.startTime,lts:i});this.send({type:t.AgoraRTCEventUploadType.WEBSOCKET_QUIT,data:a},!0)}async sendCustomReportMessage(r,n){if(this.customReportCount+=n.length,this.customReportCount>e.getParameter("CUSTOM_REPORT_LIMIT"))throw new e.AgoraRTCError(e.AgoraRTCErrorCode.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const o=Date.now(),i=n.map((e=>({type:t.AgoraRTCEventUploadType.USER_ANALYTICS,data:dv(dv({sid:r},e),{},{lts:o})})));try{e.getParameter("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(i):await this.postDataToStatsCollector(i)}catch(t){throw iv.error("send custom report message failed",t.toString()),new e.AgoraRTCError(e.AgoraRTCErrorCode.CUSTOM_REPORT_SEND_FAILED,t.message)}}sendApiInvoke(r){const n=e.getParameter("NOT_REPORT_EVENT");if(r.tag&&sl(n)&&sl(n).call(n,r.tag))return!1;if(null===r.sid)return this.apiInvokeUploadPendingItems.push(r),!1;const o=this.baseInfoMap.get(r.sid);if(!o)return this.apiInvokeUploadPendingItems.push(r),!1;const{cname:i,uid:a,cid:s}=o.info;let c;if(r.lts=r.lts||Date.now(),r.error)if(r.error instanceof e.AgoraRTCError){const{code:t,message:e}=r.error;c=t||(e||r.error.toString())}else c=r.error.toString();const u={invokeId:r.invokeId,sid:r.sid,cname:i,cid:s,uid:a,lts:r.lts,success:r.success,elapse:r.lts-o.startTime,execElapse:r.lts-r.apiInvokeTime,apiName:r.name,options:r.options?JSON.stringify(r.options):void 0,execStates:r.states?JSON.stringify(r.states):void 0,execResult:r.result?JSON.stringify(r.result):void 0,errorCode:r.error?c:void 0,errorMsg:r.error?JSON.stringify(r.error):void 0};return this.send({type:t.AgoraRTCEventUploadType.API_INVOKE,data:u},!1),!0}appendSessionId(){hv.__CLIENT_LIST__.forEach((t=>{if(t._sessionId){const e=this.apiInvokeUploadPendingItems.length;for(let r=0;r<e;r++){const e=this.apiInvokeUploadPendingItems.shift();e&&(e.sid=t._sessionId,this.sendApiInvoke(Object.assign({},e)))}}}))}send(t,r){if(r)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>e.getParameter("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,r){const n=[],o=[];for(;t.length;){const e=t.shift();n.length<20?n.push(e):o.push(e)}t.push(...o);for(const t of[...n]){var i;if(-1!==this.ltsList.indexOf(t.data.lts))t.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(t.data.lts);else this.ltsList.push(t.data.lts),Hl(i=this.ltsList).call(i,((t,e)=>t-e))}r||(this.lastSendNormalEventTime=Date.now());return e.getParameter("ENABLE_EVENT_REPORT")?(n.length&&(e.getParameter("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((t=>n=>{e.getParameter("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(t):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(t),this.normalEventUploadPendingItems.length>e.getParameter("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-e.getParameter("NORMAL_EVENT_QUEUE_CAPACITY")),iv.warning("report: drop normal events"))))})(n)),t):t}async postDataToStatsCollector2(r){e.networkIndicator.networkState===e.NETWORK_STATE.OFFLINE&&await qg.race([e.networkIndicator.onlineWaiter,e.wait(2*e.DEFAULT_RETRY_CONFIG.maxRetryTimeout)]);const n=r=>{let n=new Uint8Array;return r.forEach((r=>{const o=e.getMessageEncoding(JSON.stringify(r.data)),i=new ArrayBuffer(5),a=(e=>{let r=0;return Object.entries(t.AgoraRTCEventUploadType).forEach((t=>{let[n,o]=t;o===e.type&&(r=EventNameToID[n])})),r})(r),s=new DataView(i);s.setUint16(0,o.byteLength,!0),s.setUint8(2,255&a),s.setUint8(3,a>>>8&255),s.setUint8(4,a>>>16&255),n=e.appendBuffer(n,new Uint8Array(i)),n=e.appendBuffer(n,o)})),n},o="event";let i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(e.getParameter("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(o):"https://".concat(e.getParameter("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(o);for(let t=0;t<2;t+=1){1===t&&(i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(e.getParameter("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(o):"https://".concat(e.getParameter("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(o));try{await e.post(i,{timeout:1e4,data:n(r),headers:dv(dv({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===t)throw e;continue}return}}async postDataToStatsCollector(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map((t=>JSON.stringify(t))),vid:(t=>{const e=t&&t.data.sid&&this.baseInfoMap.get(t.data.sid);return e&&e.info.vid&&+e.info.vid||0})(t[0])};e.networkIndicator.networkState===e.NETWORK_STATE.OFFLINE&&await qg.race([e.networkIndicator.onlineWaiter,e.wait(2*e.DEFAULT_RETRY_CONFIG.maxRetryTimeout)]);const o=r?"/events/proto-raws":"/events/messages";let i=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(e.getParameter("EVENT_REPORT_DOMAIN"),"&p=").concat(e.getParameter("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(e.getParameter("EVENT_REPORT_DOMAIN"),":").concat(e.getParameter("STATS_COLLECTOR_PORT")).concat(o));for(let t=0;t<2;t+=1){1===t&&(i=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(e.getParameter("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(e.getParameter("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(e.getParameter("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(e.getParameter("STATS_COLLECTOR_PORT")).concat(o)));try{r?await e.postProtobuf(i,{timeout:1e4,data:n}):await e.post(i,{timeout:1e4,data:n})}catch(e){if(1===t)throw e;continue}return}}createBaseInfo(t,e){const r=Object.assign({},cv);return r.sid=t,this.baseInfoMap.set(t,{info:r,startTime:e}),r}reportResourceTiming(t,r){const n=performance.getEntriesByName(t),o=n[n.length-1];o&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:o,tag:e.AgoraAPITag.TRACER}).onSuccess()}}hv.__CLIENT_LIST__=[];const Ev=new hv;zg.on("REPORT_LOG_UPLOAD",(t=>{t.networkState=e.networkIndicator.networkState,Ev.reportApiInvoke(null,{name:"logUploadError",options:t,tag:e.AgoraAPITag.TRACER})})),t.AgoraLogger=ov,t.AgoraRTCEventReport=hv,t.EVENT_BASE_TEMPLATE=cv,t.apiInvoke=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r,n,o){const i=o.value;if("function"==typeof i){const a=t.className||r.__className__||("AgoraRTCClient"===r.constructor.name?"Client":r.constructor.name);o.value=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];let c=o;if(t.argsMap)try{c=t.argsMap(this,...o)}catch(t){iv.warning(t),c=[]}try{JSON.stringify(c)}catch(t){iv.warning("arguments for method ".concat(a,".").concat(String(n)," not serializable for apiInvoke.")),c=[]}const u=(t.report||Ev).reportApiInvoke(this._sessionId||null,{name:"".concat(a,".").concat(String(n)),options:c,tag:e.AgoraAPITag.TRACER,reportResult:t.reportResult},t.throttleTime);try{const e=i.apply(this,o);return e instanceof qg?e.then((e=>(u.onSuccess(t.reportResult&&e),e))).catch((t=>{throw u.onError(t),t})):(u.onSuccess(t.reportResult&&e),e)}catch(t){throw u.onError(t),t}}}return o}},t.isEventCustomReportParams=function(t){return e.checkValidString(t.reportId,"params.reportId",0,100,!1),e.checkValidString(t.category,"params.category",0,100,!1),e.checkValidString(t.event,"params.event",0,100,!1),e.checkValidString(t.label,"params.label",0,100,!1),e.checkValidNumber(t.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0},t.logReportBus=zg,t.logger=iv,t.report=Ev}));
