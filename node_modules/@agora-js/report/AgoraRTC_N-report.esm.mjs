/**
 * AgoraWebSDK_N-v4.20.0-0-g334e514b-dirty Copyright AgoraInc.
 */

import{EventEmitter as t,setParameter as e,getParameter as r,VERSION as n,retryable as o,checkValidString as i,checkValidNumber as a,networkIndicator as s,AgoraAPITag as c,wait as u,AgoraRTCErrorCode as l,AgoraRTCError as p,throttleByKey as f,IS_GLOBAL_VERSION as d,BUILD as h,dividePackage as E,NETWORK_STATE as v,DEFAULT_RETRY_CONFIG as g,post as y,postProtobuf as S,getMessageEncoding as m,appendBuffer as _}from"@agora-js/shared";import T from"axios";var O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I={exports:{}},b=function(t){return t&&t.Math==Math&&t},A=b("object"==typeof globalThis&&globalThis)||b("object"==typeof window&&window)||b("object"==typeof self&&self)||b("object"==typeof O&&O)||function(){return this}()||O||Function("return this")(),P=function(t){try{return!!t()}catch(t){return!0}},w=!P((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),N=w,D=Function.prototype,L=D.apply,C=D.call,U="object"==typeof Reflect&&Reflect.apply||(N?C.bind(L):function(){return C.apply(L,arguments)}),M=w,j=Function.prototype,x=j.call,W=M&&j.bind.bind(x,x),k=M?W:function(t){return function(){return x.apply(t,arguments)}},V=k,F=V({}.toString),G=V("".slice),B=function(t){return G(F(t),8,-1)},J=B,Y=k,K=function(t){if("Function"===J(t))return Y(t)},H="object"==typeof document&&document.all,Q={all:H,IS_HTMLDDA:void 0===H&&void 0!==H},X=Q.all,q=Q.IS_HTMLDDA?function(t){return"function"==typeof t||t===X}:function(t){return"function"==typeof t},z={},$=!P((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Z=w,tt=Function.prototype.call,et=Z?tt.bind(tt):function(){return tt.apply(tt,arguments)},rt={},nt={}.propertyIsEnumerable,ot=Object.getOwnPropertyDescriptor,it=ot&&!nt.call({1:2},1);rt.f=it?function(t){var e=ot(this,t);return!!e&&e.enumerable}:nt;var at,st,ct=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ut=P,lt=B,pt=Object,ft=k("".split),dt=ut((function(){return!pt("z").propertyIsEnumerable(0)}))?function(t){return"String"==lt(t)?ft(t,""):pt(t)}:pt,ht=function(t){return null==t},Et=ht,vt=TypeError,gt=function(t){if(Et(t))throw vt("Can't call method on "+t);return t},yt=dt,St=gt,mt=function(t){return yt(St(t))},_t=q,Tt=Q.all,Ot=Q.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:_t(t)||t===Tt}:function(t){return"object"==typeof t?null!==t:_t(t)},Rt={},It=Rt,bt=A,At=q,Pt=function(t){return At(t)?t:void 0},wt=function(t,e){return arguments.length<2?Pt(It[t])||Pt(bt[t]):It[t]&&It[t][e]||bt[t]&&bt[t][e]},Nt=k({}.isPrototypeOf),Dt="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Lt=A,Ct=Dt,Ut=Lt.process,Mt=Lt.Deno,jt=Ut&&Ut.versions||Mt&&Mt.version,xt=jt&&jt.v8;xt&&(st=(at=xt.split("."))[0]>0&&at[0]<4?1:+(at[0]+at[1])),!st&&Ct&&(!(at=Ct.match(/Edge\/(\d+)/))||at[1]>=74)&&(at=Ct.match(/Chrome\/(\d+)/))&&(st=+at[1]);var Wt=st,kt=Wt,Vt=P,Ft=A.String,Gt=!!Object.getOwnPropertySymbols&&!Vt((function(){var t=Symbol();return!Ft(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&kt&&kt<41})),Bt=Gt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Jt=wt,Yt=q,Kt=Nt,Ht=Object,Qt=Bt?function(t){return"symbol"==typeof t}:function(t){var e=Jt("Symbol");return Yt(e)&&Kt(e.prototype,Ht(t))},Xt=String,qt=function(t){try{return Xt(t)}catch(t){return"Object"}},zt=q,$t=qt,Zt=TypeError,te=function(t){if(zt(t))return t;throw Zt($t(t)+" is not a function")},ee=te,re=ht,ne=function(t,e){var r=t[e];return re(r)?void 0:ee(r)},oe=et,ie=q,ae=Ot,se=TypeError,ce={exports:{}},ue=A,le=Object.defineProperty,pe=function(t,e){try{le(ue,t,{value:e,configurable:!0,writable:!0})}catch(r){ue[t]=e}return e},fe="__core-js_shared__",de=A[fe]||pe(fe,{}),he=de;(ce.exports=function(t,e){return he[t]||(he[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Ee=ce.exports,ve=gt,ge=Object,ye=function(t){return ge(ve(t))},Se=ye,me=k({}.hasOwnProperty),_e=Object.hasOwn||function(t,e){return me(Se(t),e)},Te=k,Oe=0,Re=Math.random(),Ie=Te(1..toString),be=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ie(++Oe+Re,36)},Ae=Ee,Pe=_e,we=be,Ne=Gt,De=Bt,Le=A.Symbol,Ce=Ae("wks"),Ue=De?Le.for||Le:Le&&Le.withoutSetter||we,Me=function(t){return Pe(Ce,t)||(Ce[t]=Ne&&Pe(Le,t)?Le[t]:Ue("Symbol."+t)),Ce[t]},je=et,xe=Ot,We=Qt,ke=ne,Ve=function(t,e){var r,n;if("string"===e&&ie(r=t.toString)&&!ae(n=oe(r,t)))return n;if(ie(r=t.valueOf)&&!ae(n=oe(r,t)))return n;if("string"!==e&&ie(r=t.toString)&&!ae(n=oe(r,t)))return n;throw se("Can't convert object to primitive value")},Fe=TypeError,Ge=Me("toPrimitive"),Be=function(t,e){if(!xe(t)||We(t))return t;var r,n=ke(t,Ge);if(n){if(void 0===e&&(e="default"),r=je(n,t,e),!xe(r)||We(r))return r;throw Fe("Can't convert object to primitive value")}return void 0===e&&(e="number"),Ve(t,e)},Je=Qt,Ye=function(t){var e=Be(t,"string");return Je(e)?e:e+""},Ke=Ot,He=A.document,Qe=Ke(He)&&Ke(He.createElement),Xe=function(t){return Qe?He.createElement(t):{}},qe=Xe,ze=!$&&!P((function(){return 7!=Object.defineProperty(qe("div"),"a",{get:function(){return 7}}).a})),$e=$,Ze=et,tr=rt,er=ct,rr=mt,nr=Ye,or=_e,ir=ze,ar=Object.getOwnPropertyDescriptor;z.f=$e?ar:function(t,e){if(t=rr(t),e=nr(e),ir)try{return ar(t,e)}catch(t){}if(or(t,e))return er(!Ze(tr.f,t,e),t[e])};var sr=P,cr=q,ur=/#|\.prototype\./,lr=function(t,e){var r=fr[pr(t)];return r==hr||r!=dr&&(cr(e)?sr(e):!!e)},pr=lr.normalize=function(t){return String(t).replace(ur,".").toLowerCase()},fr=lr.data={},dr=lr.NATIVE="N",hr=lr.POLYFILL="P",Er=lr,vr=te,gr=w,yr=K(K.bind),Sr=function(t,e){return vr(t),void 0===e?t:gr?yr(t,e):function(){return t.apply(e,arguments)}},mr={},_r=$&&P((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Tr=Ot,Or=String,Rr=TypeError,Ir=function(t){if(Tr(t))return t;throw Rr(Or(t)+" is not an object")},br=$,Ar=ze,Pr=_r,wr=Ir,Nr=Ye,Dr=TypeError,Lr=Object.defineProperty,Cr=Object.getOwnPropertyDescriptor,Ur="enumerable",Mr="configurable",jr="writable";mr.f=br?Pr?function(t,e,r){if(wr(t),e=Nr(e),wr(r),"function"==typeof t&&"prototype"===e&&"value"in r&&jr in r&&!r[jr]){var n=Cr(t,e);n&&n[jr]&&(t[e]=r.value,r={configurable:Mr in r?r[Mr]:n[Mr],enumerable:Ur in r?r[Ur]:n[Ur],writable:!1})}return Lr(t,e,r)}:Lr:function(t,e,r){if(wr(t),e=Nr(e),wr(r),Ar)try{return Lr(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Dr("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var xr=mr,Wr=ct,kr=$?function(t,e,r){return xr.f(t,e,Wr(1,r))}:function(t,e,r){return t[e]=r,t},Vr=A,Fr=U,Gr=K,Br=q,Jr=z.f,Yr=Er,Kr=Rt,Hr=Sr,Qr=kr,Xr=_e,qr=function(t){var e=function(r,n,o){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,n)}return new t(r,n,o)}return Fr(t,this,arguments)};return e.prototype=t.prototype,e},zr=function(t,e){var r,n,o,i,a,s,c,u,l,p=t.target,f=t.global,d=t.stat,h=t.proto,E=f?Vr:d?Vr[p]:(Vr[p]||{}).prototype,v=f?Kr:Kr[p]||Qr(Kr,p,{})[p],g=v.prototype;for(i in e)n=!(r=Yr(f?i:p+(d?".":"#")+i,t.forced))&&E&&Xr(E,i),s=v[i],n&&(c=t.dontCallGetSet?(l=Jr(E,i))&&l.value:E[i]),a=n&&c?c:e[i],n&&typeof s==typeof a||(u=t.bind&&n?Hr(a,Vr):t.wrap&&n?qr(a):h&&Br(a)?Gr(a):a,(t.sham||a&&a.sham||s&&s.sham)&&Qr(u,"sham",!0),Qr(v,i,u),h&&(Xr(Kr,o=p+"Prototype")||Qr(Kr,o,{}),Qr(Kr[o],i,a),t.real&&g&&(r||!g[i])&&Qr(g,i,a)))},$r=zr,Zr=$,tn=mr.f;$r({target:"Object",stat:!0,forced:Object.defineProperty!==tn,sham:!Zr},{defineProperty:tn});var en=Rt.Object,rn=I.exports=function(t,e,r){return en.defineProperty(t,e,r)};en.defineProperty.sham&&(rn.sham=!0);var nn=R(I.exports),on=B,an=Array.isArray||function(t){return"Array"==on(t)},sn=Math.ceil,cn=Math.floor,un=Math.trunc||function(t){var e=+t;return(e>0?cn:sn)(e)},ln=function(t){var e=+t;return e!=e||0===e?0:un(e)},pn=ln,fn=Math.min,dn=function(t){return t>0?fn(pn(t),9007199254740991):0},hn=function(t){return dn(t.length)},En=TypeError,vn=Ye,gn=mr,yn=ct,Sn=function(t,e,r){var n=vn(e);n in t?gn.f(t,n,yn(0,r)):t[n]=r},mn={};mn[Me("toStringTag")]="z";var _n="[object z]"===String(mn),Tn=_n,On=q,Rn=B,In=Me("toStringTag"),bn=Object,An="Arguments"==Rn(function(){return arguments}()),Pn=Tn?Rn:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=bn(t),In))?r:An?Rn(e):"Object"==(n=Rn(e))&&On(e.callee)?"Arguments":n},wn=q,Nn=de,Dn=k(Function.toString);wn(Nn.inspectSource)||(Nn.inspectSource=function(t){return Dn(t)});var Ln=Nn.inspectSource,Cn=k,Un=P,Mn=q,jn=Pn,xn=Ln,Wn=function(){},kn=[],Vn=wt("Reflect","construct"),Fn=/^\s*(?:class|function)\b/,Gn=Cn(Fn.exec),Bn=!Fn.exec(Wn),Jn=function(t){if(!Mn(t))return!1;try{return Vn(Wn,kn,t),!0}catch(t){return!1}},Yn=function(t){if(!Mn(t))return!1;switch(jn(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Bn||!!Gn(Fn,xn(t))}catch(t){return!0}};Yn.sham=!0;var Kn=!Vn||Un((function(){var t;return Jn(Jn.call)||!Jn(Object)||!Jn((function(){t=!0}))||t}))?Yn:Jn,Hn=an,Qn=Kn,Xn=Ot,qn=Me("species"),zn=Array,$n=function(t){var e;return Hn(t)&&(e=t.constructor,(Qn(e)&&(e===zn||Hn(e.prototype))||Xn(e)&&null===(e=e[qn]))&&(e=void 0)),void 0===e?zn:e},Zn=function(t,e){return new($n(t))(0===e?0:e)},to=P,eo=Wt,ro=Me("species"),no=zr,oo=P,io=an,ao=Ot,so=ye,co=hn,uo=function(t){if(t>9007199254740991)throw En("Maximum allowed index exceeded");return t},lo=Sn,po=Zn,fo=function(t){return eo>=51||!to((function(){var e=[];return(e.constructor={})[ro]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},ho=Wt,Eo=Me("isConcatSpreadable"),vo=ho>=51||!oo((function(){var t=[];return t[Eo]=!1,t.concat()[0]!==t})),go=function(t){if(!ao(t))return!1;var e=t[Eo];return void 0!==e?!!e:io(t)};no({target:"Array",proto:!0,arity:1,forced:!vo||!fo("concat")},{concat:function(t){var e,r,n,o,i,a=so(this),s=po(a,0),c=0;for(e=-1,n=arguments.length;e<n;e++)if(go(i=-1===e?a:arguments[e]))for(o=co(i),uo(c+o),r=0;r<o;r++,c++)r in i&&lo(s,c,i[r]);else uo(c+1),lo(s,c++,i);return s.length=c,s}});var yo=Pn,So=String,mo=function(t){if("Symbol"===yo(t))throw TypeError("Cannot convert a Symbol value to a string");return So(t)},_o={},To=ln,Oo=Math.max,Ro=Math.min,Io=function(t,e){var r=To(t);return r<0?Oo(r+e,0):Ro(r,e)},bo=mt,Ao=Io,Po=hn,wo=function(t){return function(e,r,n){var o,i=bo(e),a=Po(i),s=Ao(n,a);if(t&&r!=r){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===r)return t||s||0;return!t&&-1}},No={includes:wo(!0),indexOf:wo(!1)},Do={},Lo=_e,Co=mt,Uo=No.indexOf,Mo=Do,jo=k([].push),xo=function(t,e){var r,n=Co(t),o=0,i=[];for(r in n)!Lo(Mo,r)&&Lo(n,r)&&jo(i,r);for(;e.length>o;)Lo(n,r=e[o++])&&(~Uo(i,r)||jo(i,r));return i},Wo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ko=xo,Vo=Wo,Fo=Object.keys||function(t){return ko(t,Vo)},Go=$,Bo=_r,Jo=mr,Yo=Ir,Ko=mt,Ho=Fo;_o.f=Go&&!Bo?Object.defineProperties:function(t,e){Yo(t);for(var r,n=Ko(e),o=Ho(e),i=o.length,a=0;i>a;)Jo.f(t,r=o[a++],n[r]);return t};var Qo,Xo=wt("document","documentElement"),qo=be,zo=Ee("keys"),$o=function(t){return zo[t]||(zo[t]=qo(t))},Zo=Ir,ti=_o,ei=Wo,ri=Do,ni=Xo,oi=Xe,ii="prototype",ai="script",si=$o("IE_PROTO"),ci=function(){},ui=function(t){return"<"+ai+">"+t+"</"+ai+">"},li=function(t){t.write(ui("")),t.close();var e=t.parentWindow.Object;return t=null,e},pi=function(){try{Qo=new ActiveXObject("htmlfile")}catch(t){}var t,e,r;pi="undefined"!=typeof document?document.domain&&Qo?li(Qo):(e=oi("iframe"),r="java"+ai+":",e.style.display="none",ni.appendChild(e),e.src=String(r),(t=e.contentWindow.document).open(),t.write(ui("document.F=Object")),t.close(),t.F):li(Qo);for(var n=ei.length;n--;)delete pi[ii][ei[n]];return pi()};ri[si]=!0;var fi=Object.create||function(t,e){var r;return null!==t?(ci[ii]=Zo(t),r=new ci,ci[ii]=null,r[si]=t):r=pi(),void 0===e?r:ti.f(r,e)},di={},hi=xo,Ei=Wo.concat("length","prototype");di.f=Object.getOwnPropertyNames||function(t){return hi(t,Ei)};var vi={},gi=Io,yi=hn,Si=Sn,mi=Array,_i=Math.max,Ti=function(t,e,r){for(var n=yi(t),o=gi(e,n),i=gi(void 0===r?n:r,n),a=mi(_i(i-o,0)),s=0;o<i;o++,s++)Si(a,s,t[o]);return a.length=s,a},Oi=B,Ri=mt,Ii=di.f,bi=Ti,Ai="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];vi.f=function(t){return Ai&&"Window"==Oi(t)?function(t){try{return Ii(t)}catch(t){return bi(Ai)}}(t):Ii(Ri(t))};var Pi={};Pi.f=Object.getOwnPropertySymbols;var wi=kr,Ni=function(t,e,r,n){return n&&n.enumerable?t[e]=r:wi(t,e,r),t},Di=mr,Li=function(t,e,r){return Di.f(t,e,r)},Ci={},Ui=Me;Ci.f=Ui;var Mi,ji,xi,Wi=Rt,ki=_e,Vi=Ci,Fi=mr.f,Gi=function(t){var e=Wi.Symbol||(Wi.Symbol={});ki(e,t)||Fi(e,t,{value:Vi.f(t)})},Bi=et,Ji=wt,Yi=Me,Ki=Ni,Hi=function(){var t=Ji("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=Yi("toPrimitive");e&&!e[n]&&Ki(e,n,(function(t){return Bi(r,this)}),{arity:1})},Qi=Pn,Xi=_n?{}.toString:function(){return"[object "+Qi(this)+"]"},qi=_n,zi=mr.f,$i=kr,Zi=_e,ta=Xi,ea=Me("toStringTag"),ra=function(t,e,r,n){if(t){var o=r?t:t.prototype;Zi(o,ea)||zi(o,ea,{configurable:!0,value:e}),n&&!qi&&$i(o,"toString",ta)}},na=q,oa=A.WeakMap,ia=na(oa)&&/native code/.test(String(oa)),aa=A,sa=Ot,ca=kr,ua=_e,la=de,pa=$o,fa=Do,da="Object already initialized",ha=aa.TypeError,Ea=aa.WeakMap;if(ia||la.state){var va=la.state||(la.state=new Ea);va.get=va.get,va.has=va.has,va.set=va.set,Mi=function(t,e){if(va.has(t))throw ha(da);return e.facade=t,va.set(t,e),e},ji=function(t){return va.get(t)||{}},xi=function(t){return va.has(t)}}else{var ga=pa("state");fa[ga]=!0,Mi=function(t,e){if(ua(t,ga))throw ha(da);return e.facade=t,ca(t,ga,e),e},ji=function(t){return ua(t,ga)?t[ga]:{}},xi=function(t){return ua(t,ga)}}var ya={set:Mi,get:ji,has:xi,enforce:function(t){return xi(t)?ji(t):Mi(t,{})},getterFor:function(t){return function(e){var r;if(!sa(e)||(r=ji(e)).type!==t)throw ha("Incompatible receiver, "+t+" required");return r}}},Sa=Sr,ma=dt,_a=ye,Ta=hn,Oa=Zn,Ra=k([].push),Ia=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,s=5==t||i;return function(c,u,l,p){for(var f,d,h=_a(c),E=ma(h),v=Sa(u,l),g=Ta(E),y=0,S=p||Oa,m=e?S(c,g):r||a?S(c,0):void 0;g>y;y++)if((s||y in E)&&(d=v(f=E[y],y,h),t))if(e)m[y]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return y;case 2:Ra(m,f)}else switch(t){case 4:return!1;case 7:Ra(m,f)}return i?-1:n||o?o:m}},ba={forEach:Ia(0),map:Ia(1),filter:Ia(2),some:Ia(3),every:Ia(4),find:Ia(5),findIndex:Ia(6),filterReject:Ia(7)},Aa=zr,Pa=A,wa=et,Na=k,Da=$,La=Gt,Ca=P,Ua=_e,Ma=Nt,ja=Ir,xa=mt,Wa=Ye,ka=mo,Va=ct,Fa=fi,Ga=Fo,Ba=di,Ja=vi,Ya=Pi,Ka=z,Ha=mr,Qa=_o,Xa=rt,qa=Ni,za=Li,$a=Ee,Za=Do,ts=be,es=Me,rs=Ci,ns=Gi,os=Hi,is=ra,as=ya,ss=ba.forEach,cs=$o("hidden"),us="Symbol",ls="prototype",ps=as.set,fs=as.getterFor(us),ds=Object[ls],hs=Pa.Symbol,Es=hs&&hs[ls],vs=Pa.TypeError,gs=Pa.QObject,ys=Ka.f,Ss=Ha.f,ms=Ja.f,_s=Xa.f,Ts=Na([].push),Os=$a("symbols"),Rs=$a("op-symbols"),Is=$a("wks"),bs=!gs||!gs[ls]||!gs[ls].findChild,As=Da&&Ca((function(){return 7!=Fa(Ss({},"a",{get:function(){return Ss(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=ys(ds,e);n&&delete ds[e],Ss(t,e,r),n&&t!==ds&&Ss(ds,e,n)}:Ss,Ps=function(t,e){var r=Os[t]=Fa(Es);return ps(r,{type:us,tag:t,description:e}),Da||(r.description=e),r},ws=function(t,e,r){t===ds&&ws(Rs,e,r),ja(t);var n=Wa(e);return ja(r),Ua(Os,n)?(r.enumerable?(Ua(t,cs)&&t[cs][n]&&(t[cs][n]=!1),r=Fa(r,{enumerable:Va(0,!1)})):(Ua(t,cs)||Ss(t,cs,Va(1,{})),t[cs][n]=!0),As(t,n,r)):Ss(t,n,r)},Ns=function(t,e){ja(t);var r=xa(e),n=Ga(r).concat(Us(r));return ss(n,(function(e){Da&&!wa(Ds,r,e)||ws(t,e,r[e])})),t},Ds=function(t){var e=Wa(t),r=wa(_s,this,e);return!(this===ds&&Ua(Os,e)&&!Ua(Rs,e))&&(!(r||!Ua(this,e)||!Ua(Os,e)||Ua(this,cs)&&this[cs][e])||r)},Ls=function(t,e){var r=xa(t),n=Wa(e);if(r!==ds||!Ua(Os,n)||Ua(Rs,n)){var o=ys(r,n);return!o||!Ua(Os,n)||Ua(r,cs)&&r[cs][n]||(o.enumerable=!0),o}},Cs=function(t){var e=ms(xa(t)),r=[];return ss(e,(function(t){Ua(Os,t)||Ua(Za,t)||Ts(r,t)})),r},Us=function(t){var e=t===ds,r=ms(e?Rs:xa(t)),n=[];return ss(r,(function(t){!Ua(Os,t)||e&&!Ua(ds,t)||Ts(n,Os[t])})),n};La||(qa(Es=(hs=function(){if(Ma(Es,this))throw vs("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?ka(arguments[0]):void 0,e=ts(t),r=function(t){this===ds&&wa(r,Rs,t),Ua(this,cs)&&Ua(this[cs],e)&&(this[cs][e]=!1),As(this,e,Va(1,t))};return Da&&bs&&As(ds,e,{configurable:!0,set:r}),Ps(e,t)})[ls],"toString",(function(){return fs(this).tag})),qa(hs,"withoutSetter",(function(t){return Ps(ts(t),t)})),Xa.f=Ds,Ha.f=ws,Qa.f=Ns,Ka.f=Ls,Ba.f=Ja.f=Cs,Ya.f=Us,rs.f=function(t){return Ps(es(t),t)},Da&&za(Es,"description",{configurable:!0,get:function(){return fs(this).description}})),Aa({global:!0,constructor:!0,wrap:!0,forced:!La,sham:!La},{Symbol:hs}),ss(Ga(Is),(function(t){ns(t)})),Aa({target:us,stat:!0,forced:!La},{useSetter:function(){bs=!0},useSimple:function(){bs=!1}}),Aa({target:"Object",stat:!0,forced:!La,sham:!Da},{create:function(t,e){return void 0===e?Fa(t):Ns(Fa(t),e)},defineProperty:ws,defineProperties:Ns,getOwnPropertyDescriptor:Ls}),Aa({target:"Object",stat:!0,forced:!La},{getOwnPropertyNames:Cs}),os(),is(hs,us),Za[cs]=!0;var Ms=Gt&&!!Symbol.for&&!!Symbol.keyFor,js=zr,xs=wt,Ws=_e,ks=mo,Vs=Ee,Fs=Ms,Gs=Vs("string-to-symbol-registry"),Bs=Vs("symbol-to-string-registry");js({target:"Symbol",stat:!0,forced:!Fs},{for:function(t){var e=ks(t);if(Ws(Gs,e))return Gs[e];var r=xs("Symbol")(e);return Gs[e]=r,Bs[r]=e,r}});var Js=zr,Ys=_e,Ks=Qt,Hs=qt,Qs=Ms,Xs=Ee("symbol-to-string-registry");Js({target:"Symbol",stat:!0,forced:!Qs},{keyFor:function(t){if(!Ks(t))throw TypeError(Hs(t)+" is not a symbol");if(Ys(Xs,t))return Xs[t]}});var qs=k([].slice),zs=an,$s=q,Zs=B,tc=mo,ec=k([].push),rc=zr,nc=wt,oc=U,ic=et,ac=k,sc=P,cc=q,uc=Qt,lc=qs,pc=function(t){if($s(t))return t;if(zs(t)){for(var e=t.length,r=[],n=0;n<e;n++){var o=t[n];"string"==typeof o?ec(r,o):"number"!=typeof o&&"Number"!=Zs(o)&&"String"!=Zs(o)||ec(r,tc(o))}var i=r.length,a=!0;return function(t,e){if(a)return a=!1,e;if(zs(this))return e;for(var n=0;n<i;n++)if(r[n]===t)return e}}},fc=Gt,dc=String,hc=nc("JSON","stringify"),Ec=ac(/./.exec),vc=ac("".charAt),gc=ac("".charCodeAt),yc=ac("".replace),Sc=ac(1..toString),mc=/[\uD800-\uDFFF]/g,_c=/^[\uD800-\uDBFF]$/,Tc=/^[\uDC00-\uDFFF]$/,Oc=!fc||sc((function(){var t=nc("Symbol")();return"[null]"!=hc([t])||"{}"!=hc({a:t})||"{}"!=hc(Object(t))})),Rc=sc((function(){return'"\\udf06\\ud834"'!==hc("\udf06\ud834")||'"\\udead"'!==hc("\udead")})),Ic=function(t,e){var r=lc(arguments),n=pc(e);if(cc(n)||void 0!==t&&!uc(t))return r[1]=function(t,e){if(cc(n)&&(e=ic(n,this,dc(t),e)),!uc(e))return e},oc(hc,null,r)},bc=function(t,e,r){var n=vc(r,e-1),o=vc(r,e+1);return Ec(_c,t)&&!Ec(Tc,o)||Ec(Tc,t)&&!Ec(_c,n)?"\\u"+Sc(gc(t,0),16):t};hc&&rc({target:"JSON",stat:!0,arity:3,forced:Oc||Rc},{stringify:function(t,e,r){var n=lc(arguments),o=oc(Oc?Ic:hc,null,n);return Rc&&"string"==typeof o?yc(o,mc,bc):o}});var Ac=Pi,Pc=ye;zr({target:"Object",stat:!0,forced:!Gt||P((function(){Ac.f(1)}))},{getOwnPropertySymbols:function(t){var e=Ac.f;return e?e(Pc(t)):[]}}),Gi("asyncIterator"),Gi("hasInstance"),Gi("isConcatSpreadable"),Gi("iterator"),Gi("match"),Gi("matchAll"),Gi("replace"),Gi("search"),Gi("species"),Gi("split");var wc=Hi;Gi("toPrimitive"),wc();var Nc=wt,Dc=ra;Gi("toStringTag"),Dc(Nc("Symbol"),"Symbol"),Gi("unscopables"),ra(A.JSON,"JSON",!0);var Lc,Cc,Uc,Mc=Rt.Symbol,jc={},xc=$,Wc=_e,kc=Function.prototype,Vc=xc&&Object.getOwnPropertyDescriptor,Fc=Wc(kc,"name"),Gc={EXISTS:Fc,PROPER:Fc&&"something"===function(){}.name,CONFIGURABLE:Fc&&(!xc||xc&&Vc(kc,"name").configurable)},Bc=!P((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Jc=_e,Yc=q,Kc=ye,Hc=Bc,Qc=$o("IE_PROTO"),Xc=Object,qc=Xc.prototype,zc=Hc?Xc.getPrototypeOf:function(t){var e=Kc(t);if(Jc(e,Qc))return e[Qc];var r=e.constructor;return Yc(r)&&e instanceof r?r.prototype:e instanceof Xc?qc:null},$c=P,Zc=q,tu=Ot,eu=fi,ru=zc,nu=Ni,ou=Me("iterator"),iu=!1;[].keys&&("next"in(Uc=[].keys())?(Cc=ru(ru(Uc)))!==Object.prototype&&(Lc=Cc):iu=!0);var au=!tu(Lc)||$c((function(){var t={};return Lc[ou].call(t)!==t}));Zc((Lc=au?{}:eu(Lc))[ou])||nu(Lc,ou,(function(){return this}));var su={IteratorPrototype:Lc,BUGGY_SAFARI_ITERATORS:iu},cu=su.IteratorPrototype,uu=fi,lu=ct,pu=ra,fu=jc,du=function(){return this},hu=k,Eu=te,vu=q,gu=String,yu=TypeError,Su=function(t,e,r){try{return hu(Eu(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}},mu=Ir,_u=function(t){if("object"==typeof t||vu(t))return t;throw yu("Can't set "+gu(t)+" as a prototype")},Tu=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Su(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return mu(r),_u(n),e?t(r,n):r.__proto__=n,r}}():void 0),Ou=zr,Ru=et,Iu=Gc,bu=function(t,e,r,n){var o=e+" Iterator";return t.prototype=uu(cu,{next:lu(+!n,r)}),pu(t,o,!1,!0),fu[o]=du,t},Au=zc,Pu=ra,wu=Ni,Nu=jc,Du=su,Lu=Iu.PROPER,Cu=Du.BUGGY_SAFARI_ITERATORS,Uu=Me("iterator"),Mu="keys",ju="values",xu="entries",Wu=function(){return this},ku=function(t,e,r,n,o,i,a){bu(r,e,n);var s,c,u,l=function(t){if(t===o&&E)return E;if(!Cu&&t in d)return d[t];switch(t){case Mu:case ju:case xu:return function(){return new r(this,t)}}return function(){return new r(this)}},p=e+" Iterator",f=!1,d=t.prototype,h=d[Uu]||d["@@iterator"]||o&&d[o],E=!Cu&&h||l(o),v="Array"==e&&d.entries||h;if(v&&(s=Au(v.call(new t)))!==Object.prototype&&s.next&&(Pu(s,p,!0,!0),Nu[p]=Wu),Lu&&o==ju&&h&&h.name!==ju&&(f=!0,E=function(){return Ru(h,this)}),o)if(c={values:l(ju),keys:i?E:l(Mu),entries:l(xu)},a)for(u in c)(Cu||f||!(u in d))&&wu(d,u,c[u]);else Ou({target:e,proto:!0,forced:Cu||f},c);return a&&d[Uu]!==E&&wu(d,Uu,E,{name:o}),Nu[e]=E,c},Vu=function(t,e){return{value:t,done:e}},Fu=mt,Gu=jc,Bu=ya;mr.f;var Ju=ku,Yu=Vu,Ku="Array Iterator",Hu=Bu.set,Qu=Bu.getterFor(Ku);Ju(Array,"Array",(function(t,e){Hu(this,{type:Ku,target:Fu(t),index:0,kind:e})}),(function(){var t=Qu(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Yu(void 0,!0)):Yu("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),Gu.Arguments=Gu.Array;var Xu={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},qu=A,zu=Pn,$u=kr,Zu=jc,tl=Me("toStringTag");for(var el in Xu){var rl=qu[el],nl=rl&&rl.prototype;nl&&zu(nl)!==tl&&$u(nl,tl,el),Zu[el]=Zu.Array}var ol=Mc,il=Me,al=mr.f,sl=il("metadata"),cl=Function.prototype;void 0===cl[sl]&&al(cl,sl,{value:null}),Gi("dispose"),Gi("metadata");var ul=ol;Gi("asyncDispose");var ll=k,pl=wt("Symbol"),fl=pl.keyFor,dl=ll(pl.prototype.valueOf),hl=pl.isRegisteredSymbol||function(t){try{return void 0!==fl(dl(t))}catch(t){return!1}};zr({target:"Symbol",stat:!0},{isRegisteredSymbol:hl});for(var El=Ee,vl=wt,gl=k,yl=Qt,Sl=Me,ml=vl("Symbol"),_l=ml.isWellKnownSymbol,Tl=vl("Object","getOwnPropertyNames"),Ol=gl(ml.prototype.valueOf),Rl=El("wks"),Il=0,bl=Tl(ml),Al=bl.length;Il<Al;Il++)try{var Pl=bl[Il];yl(ml[Pl])&&Sl(Pl)}catch(t){}var wl=function(t){if(_l&&_l(t))return!0;try{for(var e=Ol(t),r=0,n=Tl(Rl),o=n.length;r<o;r++)if(Rl[n[r]]==e)return!0}catch(t){}return!1};zr({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:wl}),Gi("matcher"),Gi("observable"),zr({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:hl}),zr({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:wl}),Gi("metadataKey"),Gi("patternMatch"),Gi("replaceAll");var Nl=R(ul),Dl=k,Ll=ln,Cl=mo,Ul=gt,Ml=Dl("".charAt),jl=Dl("".charCodeAt),xl=Dl("".slice),Wl=function(t){return function(e,r){var n,o,i=Cl(Ul(e)),a=Ll(r),s=i.length;return a<0||a>=s?t?"":void 0:(n=jl(i,a))<55296||n>56319||a+1===s||(o=jl(i,a+1))<56320||o>57343?t?Ml(i,a):n:t?xl(i,a,a+2):o-56320+(n-55296<<10)+65536}},kl={codeAt:Wl(!1),charAt:Wl(!0)}.charAt,Vl=mo,Fl=ya,Gl=ku,Bl=Vu,Jl="String Iterator",Yl=Fl.set,Kl=Fl.getterFor(Jl);Gl(String,"String",(function(t){Yl(this,{type:Jl,string:Vl(t),index:0})}),(function(){var t,e=Kl(this),r=e.string,n=e.index;return n>=r.length?Bl(void 0,!0):(t=kl(r,n),e.index+=t.length,Bl(t,!1))}));var Hl=R(Ci.f("iterator"));function Ql(t){return Ql="function"==typeof Nl&&"symbol"==typeof Hl?function(t){return typeof t}:function(t){return t&&"function"==typeof Nl&&t.constructor===Nl&&t!==Nl.prototype?"symbol":typeof t},Ql(t)}var Xl=R(Ci.f("toPrimitive"));function ql(t){var e=function(t,e){if("object"!==Ql(t)||null===t)return t;var r=t[Xl];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ql(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ql(e)?e:String(e)}var zl=Rt,$l=function(t){return zl[t+"Prototype"]},Zl=$l("Array").keys,tp=Pn,ep=_e,rp=Nt,np=Zl,op=Array.prototype,ip={DOMTokenList:!0,NodeList:!0},ap=R((function(t){var e=t.keys;return t===op||rp(op,t)&&e===op.keys||ep(ip,tp(t))?np:e})),sp=No.includes;zr({target:"Array",proto:!0,forced:P((function(){return!Array(1).includes()}))},{includes:function(t){return sp(this,t,arguments.length>1?arguments[1]:void 0)}});var cp=$l("Array").includes,up=Ot,lp=B,pp=Me("match"),fp=function(t){var e;return up(t)&&(void 0!==(e=t[pp])?!!e:"RegExp"==lp(t))},dp=TypeError,hp=Me("match"),Ep=zr,vp=function(t){if(fp(t))throw dp("The method doesn't accept regular expressions");return t},gp=gt,yp=mo,Sp=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[hp]=!1,"/./"[t](e)}catch(t){}}return!1},mp=k("".indexOf);Ep({target:"String",proto:!0,forced:!Sp("includes")},{includes:function(t){return!!~mp(yp(gp(this)),yp(vp(t)),arguments.length>1?arguments[1]:void 0)}});var _p=$l("String").includes,Tp=Nt,Op=cp,Rp=_p,Ip=Array.prototype,bp=String.prototype,Ap=R((function(t){var e=t.includes;return t===Ip||Tp(Ip,t)&&e===Ip.includes?Op:"string"==typeof t||t===bp||Tp(bp,t)&&e===bp.includes?Rp:e})),Pp=qt,wp=TypeError,Np=Ti,Dp=Math.floor,Lp=function(t,e){var r=t.length,n=Dp(r/2);return r<8?Cp(t,e):Up(t,Lp(Np(t,0,n),e),Lp(Np(t,n),e),e)},Cp=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Up=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,s=0;a<o||s<i;)t[a+s]=a<o&&s<i?n(e[a],r[s])<=0?e[a++]:r[s++]:a<o?e[a++]:r[s++];return t},Mp=Lp,jp=P,xp=Dt.match(/firefox\/(\d+)/i),Wp=!!xp&&+xp[1],kp=/MSIE|Trident/.test(Dt),Vp=Dt.match(/AppleWebKit\/(\d+)\./),Fp=!!Vp&&+Vp[1],Gp=zr,Bp=k,Jp=te,Yp=ye,Kp=hn,Hp=function(t,e){if(!delete t[e])throw wp("Cannot delete property "+Pp(e)+" of "+Pp(t))},Qp=mo,Xp=P,qp=Mp,zp=function(t,e){var r=[][t];return!!r&&jp((function(){r.call(null,e||function(){return 1},1)}))},$p=Wp,Zp=kp,tf=Wt,ef=Fp,rf=[],nf=Bp(rf.sort),of=Bp(rf.push),af=Xp((function(){rf.sort(void 0)})),sf=Xp((function(){rf.sort(null)})),cf=zp("sort"),uf=!Xp((function(){if(tf)return tf<70;if(!($p&&$p>3)){if(Zp)return!0;if(ef)return ef<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)rf.push({k:e+n,v:r})}for(rf.sort((function(t,e){return e.v-t.v})),n=0;n<rf.length;n++)e=rf[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}}));Gp({target:"Array",proto:!0,forced:af||!sf||!cf||!uf},{sort:function(t){void 0!==t&&Jp(t);var e=Yp(this);if(uf)return void 0===t?nf(e):nf(e,t);var r,n,o=[],i=Kp(e);for(n=0;n<i;n++)n in e&&of(o,e[n]);for(qp(o,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:Qp(e)>Qp(r)?1:-1}}(t)),r=Kp(o),n=0;n<r;)e[n]=o[n++];for(;n<i;)Hp(e,n++);return e}});var lf=$l("Array").sort,pf=Nt,ff=lf,df=Array.prototype,hf=R((function(t){var e=t.sort;return t===df||pf(df,t)&&e===df.sort?ff:e})),Ef=wt,vf=di,gf=Pi,yf=Ir,Sf=k([].concat),mf=Ef("Reflect","ownKeys")||function(t){var e=vf.f(yf(t)),r=gf.f;return r?Sf(e,r(t)):e},_f=_e,Tf=mf,Of=z,Rf=mr,If=Ot,bf=kr,Af=Error,Pf=k("".replace),wf=String(Af("zxcasd").stack),Nf=/\n\s*at [^:]*:[^\n]*/,Df=Nf.test(wf),Lf=ct,Cf=!P((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Lf(1,7)),7!==t.stack)})),Uf=kr,Mf=function(t,e){if(Df&&"string"==typeof t&&!Af.prepareStackTrace)for(;e--;)t=Pf(t,Nf,"");return t},jf=Cf,xf=Error.captureStackTrace,Wf=jc,kf=Me("iterator"),Vf=Array.prototype,Ff=Pn,Gf=ne,Bf=ht,Jf=jc,Yf=Me("iterator"),Kf=function(t){if(!Bf(t))return Gf(t,Yf)||Gf(t,"@@iterator")||Jf[Ff(t)]},Hf=et,Qf=te,Xf=Ir,qf=qt,zf=Kf,$f=TypeError,Zf=et,td=Ir,ed=ne,rd=Sr,nd=et,od=Ir,id=qt,ad=function(t){return void 0!==t&&(Wf.Array===t||Vf[kf]===t)},sd=hn,cd=Nt,ud=function(t,e){var r=arguments.length<2?zf(t):e;if(Qf(r))return Xf(Hf(r,t));throw $f(qf(t)+" is not iterable")},ld=Kf,pd=function(t,e,r){var n,o;td(t);try{if(!(n=ed(t,"return"))){if("throw"===e)throw r;return r}n=Zf(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return td(n),r},fd=TypeError,dd=function(t,e){this.stopped=t,this.result=e},hd=dd.prototype,Ed=function(t,e,r){var n,o,i,a,s,c,u,l=r&&r.that,p=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),d=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),E=rd(e,l),v=function(t){return n&&pd(n,"normal",t),new dd(!0,t)},g=function(t){return p?(od(t),h?E(t[0],t[1],v):E(t[0],t[1])):h?E(t,v):E(t)};if(f)n=t.iterator;else if(d)n=t;else{if(!(o=ld(t)))throw fd(id(t)+" is not iterable");if(ad(o)){for(i=0,a=sd(t);a>i;i++)if((s=g(t[i]))&&cd(hd,s))return s;return new dd(!1)}n=ud(t,o)}for(c=f?t.next:n.next;!(u=nd(c,n)).done;){try{s=g(u.value)}catch(t){pd(n,"throw",t)}if("object"==typeof s&&s&&cd(hd,s))return s}return new dd(!1)},vd=mo,gd=zr,yd=Nt,Sd=zc,md=Tu,_d=function(t,e,r){for(var n=Tf(e),o=Rf.f,i=Of.f,a=0;a<n.length;a++){var s=n[a];_f(t,s)||r&&_f(r,s)||o(t,s,i(e,s))}},Td=fi,Od=kr,Rd=ct,Id=function(t,e){If(e)&&"cause"in e&&bf(t,"cause",e.cause)},bd=function(t,e,r,n){jf&&(xf?xf(t,e):Uf(t,"stack",Mf(r,n)))},Ad=Ed,Pd=function(t,e){return void 0===t?arguments.length<2?"":e:vd(t)},wd=Me("toStringTag"),Nd=Error,Dd=[].push,Ld=function(t,e){var r,n=yd(Cd,this);md?r=md(Nd(),n?Sd(this):Cd):(r=n?this:Td(Cd),Od(r,wd,"Error")),void 0!==e&&Od(r,"message",Pd(e)),bd(r,Ld,r.stack,1),arguments.length>2&&Id(r,arguments[2]);var o=[];return Ad(t,Dd,{that:o}),Od(r,"errors",o),r};md?md(Ld,Nd):_d(Ld,Nd,{name:!0});var Cd=Ld.prototype=Td(Nd.prototype,{constructor:Rd(1,Ld),message:Rd(1,""),name:Rd(1,"AggregateError")});gd({global:!0,constructor:!0,arity:2},{AggregateError:Ld});var Ud,Md,jd,xd,Wd="undefined"!=typeof process&&"process"==B(process),kd=wt,Vd=Li,Fd=$,Gd=Me("species"),Bd=Nt,Jd=TypeError,Yd=Kn,Kd=qt,Hd=TypeError,Qd=Ir,Xd=function(t){if(Yd(t))return t;throw Hd(Kd(t)+" is not a constructor")},qd=ht,zd=Me("species"),$d=function(t,e){var r,n=Qd(t).constructor;return void 0===n||qd(r=Qd(n)[zd])?e:Xd(r)},Zd=TypeError,th=/(?:ipad|iphone|ipod).*applewebkit/i.test(Dt),eh=A,rh=U,nh=Sr,oh=q,ih=_e,ah=P,sh=Xo,ch=qs,uh=Xe,lh=function(t,e){if(t<e)throw Zd("Not enough arguments");return t},ph=th,fh=Wd,dh=eh.setImmediate,hh=eh.clearImmediate,Eh=eh.process,vh=eh.Dispatch,gh=eh.Function,yh=eh.MessageChannel,Sh=eh.String,mh=0,_h={},Th="onreadystatechange";ah((function(){Ud=eh.location}));var Oh=function(t){if(ih(_h,t)){var e=_h[t];delete _h[t],e()}},Rh=function(t){return function(){Oh(t)}},Ih=function(t){Oh(t.data)},bh=function(t){eh.postMessage(Sh(t),Ud.protocol+"//"+Ud.host)};dh&&hh||(dh=function(t){lh(arguments.length,1);var e=oh(t)?t:gh(t),r=ch(arguments,1);return _h[++mh]=function(){rh(e,void 0,r)},Md(mh),mh},hh=function(t){delete _h[t]},fh?Md=function(t){Eh.nextTick(Rh(t))}:vh&&vh.now?Md=function(t){vh.now(Rh(t))}:yh&&!ph?(xd=(jd=new yh).port2,jd.port1.onmessage=Ih,Md=nh(xd.postMessage,xd)):eh.addEventListener&&oh(eh.postMessage)&&!eh.importScripts&&Ud&&"file:"!==Ud.protocol&&!ah(bh)?(Md=bh,eh.addEventListener("message",Ih,!1)):Md=Th in uh("script")?function(t){sh.appendChild(uh("script"))[Th]=function(){sh.removeChild(this),Oh(t)}}:function(t){setTimeout(Rh(t),0)});var Ah={set:dh,clear:hh},Ph=function(){this.head=null,this.tail=null};Ph.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var wh,Nh,Dh,Lh,Ch,Uh=Ph,Mh=/ipad|iphone|ipod/i.test(Dt)&&"undefined"!=typeof Pebble,jh=/web0s(?!.*chrome)/i.test(Dt),xh=A,Wh=Sr,kh=z.f,Vh=Ah.set,Fh=Uh,Gh=th,Bh=Mh,Jh=jh,Yh=Wd,Kh=xh.MutationObserver||xh.WebKitMutationObserver,Hh=xh.document,Qh=xh.process,Xh=xh.Promise,qh=kh(xh,"queueMicrotask"),zh=qh&&qh.value;if(!zh){var $h=new Fh,Zh=function(){var t,e;for(Yh&&(t=Qh.domain)&&t.exit();e=$h.get();)try{e()}catch(t){throw $h.head&&wh(),t}t&&t.enter()};Gh||Yh||Jh||!Kh||!Hh?!Bh&&Xh&&Xh.resolve?((Lh=Xh.resolve(void 0)).constructor=Xh,Ch=Wh(Lh.then,Lh),wh=function(){Ch(Zh)}):Yh?wh=function(){Qh.nextTick(Zh)}:(Vh=Wh(Vh,xh),wh=function(){Vh(Zh)}):(Nh=!0,Dh=Hh.createTextNode(""),new Kh(Zh).observe(Dh,{characterData:!0}),wh=function(){Dh.data=Nh=!Nh}),zh=function(t){$h.head||wh(),$h.add(t)}}var tE=zh,eE=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},rE=A.Promise,nE="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,oE=!nE&&!Wd&&"object"==typeof window&&"object"==typeof document,iE=A,aE=rE,sE=q,cE=Er,uE=Ln,lE=Me,pE=oE,fE=nE,dE=Wt,hE=aE&&aE.prototype,EE=lE("species"),vE=!1,gE=sE(iE.PromiseRejectionEvent),yE=cE("Promise",(function(){var t=uE(aE),e=t!==String(aE);if(!e&&66===dE)return!0;if(!hE.catch||!hE.finally)return!0;if(!dE||dE<51||!/native code/.test(t)){var r=new aE((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[EE]=n,!(vE=r.then((function(){}))instanceof n))return!0}return!e&&(pE||fE)&&!gE})),SE={CONSTRUCTOR:yE,REJECTION_EVENT:gE,SUBCLASSING:vE},mE={},_E=te,TE=TypeError,OE=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw TE("Bad Promise constructor");e=t,r=n})),this.resolve=_E(e),this.reject=_E(r)};mE.f=function(t){return new OE(t)};var RE,IE,bE=zr,AE=Wd,PE=A,wE=et,NE=Ni,DE=ra,LE=function(t){var e=kd(t);Fd&&e&&!e[Gd]&&Vd(e,Gd,{configurable:!0,get:function(){return this}})},CE=te,UE=q,ME=Ot,jE=function(t,e){if(Bd(e,t))return t;throw Jd("Incorrect invocation")},xE=$d,WE=Ah.set,kE=tE,VE=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}},FE=eE,GE=Uh,BE=ya,JE=rE,YE=SE,KE=mE,HE="Promise",QE=YE.CONSTRUCTOR,XE=YE.REJECTION_EVENT,qE=BE.getterFor(HE),zE=BE.set,$E=JE&&JE.prototype,ZE=JE,tv=$E,ev=PE.TypeError,rv=PE.document,nv=PE.process,ov=KE.f,iv=ov,av=!!(rv&&rv.createEvent&&PE.dispatchEvent),sv="unhandledrejection",cv=function(t){var e;return!(!ME(t)||!UE(e=t.then))&&e},uv=function(t,e){var r,n,o,i=e.value,a=1==e.state,s=a?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(a||(2===e.rejection&&hv(e),e.rejection=1),!0===s?r=i:(l&&l.enter(),r=s(i),l&&(l.exit(),o=!0)),r===t.promise?u(ev("Promise-chain cycle")):(n=cv(r))?wE(n,r,c,u):c(r)):u(i)}catch(t){l&&!o&&l.exit(),u(t)}},lv=function(t,e){t.notified||(t.notified=!0,kE((function(){for(var r,n=t.reactions;r=n.get();)uv(r,t);t.notified=!1,e&&!t.rejection&&fv(t)})))},pv=function(t,e,r){var n,o;av?((n=rv.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),PE.dispatchEvent(n)):n={promise:e,reason:r},!XE&&(o=PE["on"+t])?o(n):t===sv&&VE("Unhandled promise rejection",r)},fv=function(t){wE(WE,PE,(function(){var e,r=t.facade,n=t.value;if(dv(t)&&(e=FE((function(){AE?nv.emit("unhandledRejection",n,r):pv(sv,r,n)})),t.rejection=AE||dv(t)?2:1,e.error))throw e.value}))},dv=function(t){return 1!==t.rejection&&!t.parent},hv=function(t){wE(WE,PE,(function(){var e=t.facade;AE?nv.emit("rejectionHandled",e):pv("rejectionhandled",e,t.value)}))},Ev=function(t,e,r){return function(n){t(e,n,r)}},vv=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,lv(t,!0))},gv=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw ev("Promise can't be resolved itself");var n=cv(e);n?kE((function(){var r={done:!1};try{wE(n,e,Ev(gv,r,t),Ev(vv,r,t))}catch(e){vv(r,e,t)}})):(t.value=e,t.state=1,lv(t,!1))}catch(e){vv({done:!1},e,t)}}};QE&&(tv=(ZE=function(t){jE(this,tv),CE(t),wE(RE,this);var e=qE(this);try{t(Ev(gv,e),Ev(vv,e))}catch(t){vv(e,t)}}).prototype,(RE=function(t){zE(this,{type:HE,done:!1,notified:!1,parent:!1,reactions:new GE,rejection:!1,state:0,value:void 0})}).prototype=NE(tv,"then",(function(t,e){var r=qE(this),n=ov(xE(this,ZE));return r.parent=!0,n.ok=!UE(t)||t,n.fail=UE(e)&&e,n.domain=AE?nv.domain:void 0,0==r.state?r.reactions.add(n):kE((function(){uv(n,r)})),n.promise})),IE=function(){var t=new RE,e=qE(t);this.promise=t,this.resolve=Ev(gv,e),this.reject=Ev(vv,e)},KE.f=ov=function(t){return t===ZE||undefined===t?new IE(t):iv(t)}),bE({global:!0,constructor:!0,wrap:!0,forced:QE},{Promise:ZE}),DE(ZE,HE,!1,!0),LE(HE);var yv=Me("iterator"),Sv=!1;try{var mv=0,_v={next:function(){return{done:!!mv++}},return:function(){Sv=!0}};_v[yv]=function(){return this},Array.from(_v,(function(){throw 2}))}catch(t){}var Tv=rE,Ov=function(t,e){if(!e&&!Sv)return!1;var r=!1;try{var n={};n[yv]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Rv=SE.CONSTRUCTOR||!Ov((function(t){Tv.all(t).then(void 0,(function(){}))})),Iv=et,bv=te,Av=mE,Pv=eE,wv=Ed;zr({target:"Promise",stat:!0,forced:Rv},{all:function(t){var e=this,r=Av.f(e),n=r.resolve,o=r.reject,i=Pv((function(){var r=bv(e.resolve),i=[],a=0,s=1;wv(t,(function(t){var c=a++,u=!1;s++,Iv(r,e,t).then((function(t){u||(u=!0,i[c]=t,--s||n(i))}),o)})),--s||n(i)}));return i.error&&o(i.value),r.promise}});var Nv=zr,Dv=SE.CONSTRUCTOR;rE&&rE.prototype,Nv({target:"Promise",proto:!0,forced:Dv,real:!0},{catch:function(t){return this.then(void 0,t)}});var Lv=et,Cv=te,Uv=mE,Mv=eE,jv=Ed;zr({target:"Promise",stat:!0,forced:Rv},{race:function(t){var e=this,r=Uv.f(e),n=r.reject,o=Mv((function(){var o=Cv(e.resolve);jv(t,(function(t){Lv(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var xv=et,Wv=mE;zr({target:"Promise",stat:!0,forced:SE.CONSTRUCTOR},{reject:function(t){var e=Wv.f(this);return xv(e.reject,void 0,t),e.promise}});var kv=Ir,Vv=Ot,Fv=mE,Gv=function(t,e){if(kv(t),Vv(e)&&e.constructor===t)return e;var r=Fv.f(t);return(0,r.resolve)(e),r.promise},Bv=zr,Jv=rE,Yv=SE.CONSTRUCTOR,Kv=Gv,Hv=wt("Promise"),Qv=!Yv;Bv({target:"Promise",stat:!0,forced:true},{resolve:function(t){return Kv(Qv&&this===Hv?Jv:this,t)}});var Xv=et,qv=te,zv=mE,$v=eE,Zv=Ed;zr({target:"Promise",stat:!0,forced:Rv},{allSettled:function(t){var e=this,r=zv.f(e),n=r.resolve,o=r.reject,i=$v((function(){var r=qv(e.resolve),o=[],i=0,a=1;Zv(t,(function(t){var s=i++,c=!1;a++,Xv(r,e,t).then((function(t){c||(c=!0,o[s]={status:"fulfilled",value:t},--a||n(o))}),(function(t){c||(c=!0,o[s]={status:"rejected",reason:t},--a||n(o))}))})),--a||n(o)}));return i.error&&o(i.value),r.promise}});var tg=et,eg=te,rg=wt,ng=mE,og=eE,ig=Ed,ag="No one promise resolved";zr({target:"Promise",stat:!0,forced:Rv},{any:function(t){var e=this,r=rg("AggregateError"),n=ng.f(e),o=n.resolve,i=n.reject,a=og((function(){var n=eg(e.resolve),a=[],s=0,c=1,u=!1;ig(t,(function(t){var l=s++,p=!1;c++,tg(n,e,t).then((function(t){p||u||(u=!0,o(t))}),(function(t){p||u||(p=!0,a[l]=t,--c||i(new r(a,ag)))}))})),--c||i(new r(a,ag))}));return a.error&&i(a.value),n.promise}});var sg=zr,cg=rE,ug=P,lg=wt,pg=q,fg=$d,dg=Gv,hg=cg&&cg.prototype;sg({target:"Promise",proto:!0,real:!0,forced:!!cg&&ug((function(){hg.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=fg(this,lg("Promise")),r=pg(t);return this.then(r?function(r){return dg(e,t()).then((function(){return r}))}:t,r?function(r){return dg(e,t()).then((function(){throw r}))}:t)}});var Eg=R(Rt.Promise);const vg=new class extends t{reportLogUploadError(t){this.emit("REPORT_LOG_UPLOAD",t)}};class gg{constructor(t){this.logger=void 0,this.prefixLists=[],this.logger=t}debug(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.debug(...this.prefixLists,...e)}info(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.info(...this.prefixLists,...e)}warning(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.warning(...this.prefixLists,...e)}error(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.error(...this.prefixLists,...e)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function yg(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}function Sg(){const t=new Date,e=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return e?(null==e?void 0:e[0])+":"+t.getUTCMilliseconds():t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const mg={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},_g=Date.now(),Tg=t=>{for(const e in mg)if(Object.prototype.hasOwnProperty.call(mg,e)&&mg[e]===t)return e;return"DEFAULT"};class Og{constructor(){this.proxyServerURL=void 0,this.logLevel=mg.DEBUG,this.uploadState="collecting",this.uploadLogWaitingList=[],this.uploadLogUploadingList=[],this.uploadErrorCount=0,this.currentLogID=0,this.url=void 0,this.extLog=(t,e)=>{this.appendLogToWaitingList(t,...e)}}debug(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[mg.DEBUG].concat(e);this.log.apply(this,n)}info(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[mg.INFO].concat(e);this.log.apply(this,n)}warning(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[mg.WARNING].concat(e);this.log.apply(this,n)}warn(){this.warning(...arguments)}error(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[mg.ERROR].concat(e);this.log.apply(this,n)}upload(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=[mg.DEBUG].concat(e);this.uploadLog.apply(this,n)}setLogLevel(t){t=Math.min(Math.max(0,t),4),this.logLevel=t}enableLogUpload(){e("UPLOAD_LOG",!0)}disableLogUpload(){e("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(t){this.proxyServerURL=t}prefix(t){return new gg(this).prefix(t)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(Date.now()-_g<100)return void setTimeout((()=>{this.log(...e)}),Date.now()-_g);const o=Math.max(0,Math.min(4,e[0]));if(e[0]=yg()+" Agora-SDK [".concat(Tg(o),"]:"),this.appendLogToWaitingList(o,...e),o<this.logLevel)return;const i=yg()+" %cAgora-SDK [".concat(Tg(o),"]:");let a=[];if(!r("USE_NEW_LOG"))switch(o){case mg.DEBUG:a=[i,"color: #64B5F6;"].concat(e.slice(1)),console.log.apply(console,a);break;case mg.INFO:a=[i,"color: #1E88E5; font-weight: bold;"].concat(e.slice(1)),console.log.apply(console,a);break;case mg.WARNING:a=[i,"color: #FB8C00; font-weight: bold;"].concat(e.slice(1)),console.warn.apply(console,a);break;case mg.ERROR:a=[i,"color: #B00020; font-weight: bold;"].concat(e.slice(1)),console.error.apply(console,a)}}uploadLog(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(Date.now()-_g<100)return void setTimeout((()=>{this.uploadLog(...e)}),Date.now()-_g);const n=Math.max(0,Math.min(4,e[0]));e[0]=yg()+" Agora-SDK [".concat(Tg(n),"]:"),this.appendLogToWaitingList(n,...e)}appendLogToWaitingList(t){if(!r("UPLOAD_LOG"))return;for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];Array.isArray(n[0])?n[0][0]=Sg()+" Agora-SDK [".concat(Tg(t),"]:"):n[0]=Sg()+" Agora-SDK [".concat(Tg(t),"]:");let i="";n.forEach((t=>{"object"==typeof t&&(t=JSON.stringify(t)),i+="".concat(t," ")})),this.uploadLogWaitingList.push({payload_str:i,log_level:t,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const t=this.uploadLogUploadingList,e={sdk_version:n,process_id:r("PROCESS_ID"),payload:JSON.stringify(t)};return o((async()=>{const t=await T.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(r("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(r("LOG_UPLOAD_SERVER"),"/upload/v1")),e,{responseType:"text"});if("OK"!==t.data){const e=new Error("unexpected upload log response");throw e.response=t,e}}),(()=>(this.uploadLogUploadingList=[],!1)),(t=>(t.response?vg.reportLogUploadError({status:t.response.status,data:t.response.data,headers:t.response.headers,message:t.message}):t.request?vg.reportLogUploadError({status:t.request.status,message:t.message}):vg.reportLogUploadError({status:-1,message:t.message}),!0)),{timeout:r("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:r("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,r("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),r("UPLOAD_LOG_INTERVAL"))})).catch((t=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),r("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),r("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}}const Rg=new Og;var Ig,bg;function Ag(t){return i(t.reportId,"params.reportId",0,100,!1),i(t.category,"params.category",0,100,!1),i(t.event,"params.event",0,100,!1),i(t.label,"params.label",0,100,!1),a(t.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}!function(t){t.FREE="free",t.UPLOADING="uploading"}(Ig||(Ig={})),function(t){t[t.MISC=0]="MISC",t[t.INTERNAL_EVENT=1]="INTERNAL_EVENT",t[t.PUBLIC_EVENT=2]="PUBLIC_EVENT",t[t.WEB_EVENT=3]="WEB_EVENT",t[t.INTERNAL_API=4]="INTERNAL_API",t[t.WEB_API=5]="WEB_API",t[t.PUBLIC_API=6]="PUBLIC_API"}(bg||(bg={}));const Pg={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var wg,Ng,Dg,Lg;function Cg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ug(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Cg(Object(r),!0).forEach((function(e){var n,o,i;n=t,o=e,i=r[e],(o=ql(o))in n?nn(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cg(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}!function(t){t.PUBLISH="publish",t.SUBSCRIBE="subscribe",t.WS_COMPRESSOR_INIT="ws_compressor_init",t.SESSION_INIT="session_init",t.JOIN_CHOOSE_SERVER="join_choose_server",t.REQ_USER_ACCOUNT="req_user_account",t.JOIN_GATEWAY="join_gateway",t.REJOIN_GATEWAY="rejoin_gateway",t.STREAM_SWITCH="stream_switch",t.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",t.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",t.FIRST_VIDEO_RECEIVED="first_video_received",t.FIRST_AUDIO_RECEIVED="first_audio_received",t.FIRST_VIDEO_DECODE="first_video_decode",t.FIRST_AUDIO_DECODE="first_audio_decode",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_UPDATE_STREAM="on_update_stream",t.ON_REMOVE_STREAM="on_remove_stream",t.USER_ANALYTICS="req_user_analytics",t.PC_STATS="pc_stats",t.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities"}(wg||(wg={})),function(t){t.SESSION="io.agora.pb.Wrtc.Session",t.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",t.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",t.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",t.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",t.PUBLISH="io.agora.pb.Wrtc.Publish",t.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",t.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",t.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",t.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",t.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",t.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",t.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",t.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",t.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",t.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",t.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",t.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",t.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",t.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",t.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",t.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",t.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",t.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",t.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",t.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",t.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",t.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",t.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",t.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",t.PC_STATS="io.agora.pb.Wrtc.PCStats",t.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities"}(Ng||(Ng={})),function(t){t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(Dg||(Dg={})),function(t){t[t.SESSION=26]="SESSION",t[t.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",t[t.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",t[t.JOIN_GATEWAY=28]="JOIN_GATEWAY",t[t.PUBLISH=30]="PUBLISH",t[t.SUBSCRIBE=29]="SUBSCRIBE",t[t.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",t[t.STREAM_SWITCH=32]="STREAM_SWITCH",t[t.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",t[t.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",t[t.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",t[t.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",t[t.API_INVOKE=41]="API_INVOKE",t[t.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",t[t.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",t[t.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",t[t.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",t[t.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",t[t.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",t[t.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",t[t.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",t[t.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",t[t.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t[t.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",t[t.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",t[t.USER_ANALYTICS=1e4]="USER_ANALYTICS",t[t.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(Lg||(Lg={}));class Mg{constructor(){this.baseInfoMap=new Map,this.proxyServer=void 0,this.eventUploadTimer=void 0,this.setSessionIdTimer=void 0,this.url=void 0,this.backupUrl=void 0,this._appId=void 0,this.keyEventUploadPendingItems=[],this.normalEventUploadPendingItems=[],this.apiInvokeUploadPendingItems=[],this.apiInvokeCount=0,this.ltsList=[],this.lastSendNormalEventTime=Date.now(),this.customReportCounterTimer=void 0,this.customReportCount=0,this.extApiInvoke=async t=>{for(const e of t){const t=Ug(Ug({},e),{},{sid:null,invokeId:++this.apiInvokeCount,tag:c.TRACER});this.sendApiInvoke(t)}},this.eventUploadTimer=window.setInterval(this.doSend.bind(this),r("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),r("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return void Rg.error("adjust session ".concat(t," start time, sid is not exist or info is undefined"));const e=this.baseInfoMap.get(t),r=Date.now(),n=e.startTime;e.startTime=r,Rg.debug("rewrite session ".concat(t," startTime: ").concat(r," , ").concat(r-n,"ms")),this.baseInfoMap.set(t,e)}setAppId(t){this._appId=t}reportApiInvoke(t,e,n){e.timeout=e.timeout||6e4,e.reportResult=void 0===e.reportResult||e.reportResult;const o=Date.now();this.apiInvokeCount+=1;const i=this.apiInvokeCount,a=()=>({tag:e.tag,invokeId:i,sid:t,name:e.name,apiInvokeTime:o,options:e.options,states:e.states||null}),s=!!r("SHOW_REPORT_INVOKER_LOG");s&&Rg.info("".concat(e.name," start"),e.options);let c=!1;u(e.timeout).then((()=>{c||(this.sendApiInvoke(Ug(Ug({},a()),{},{error:l.API_INVOKE_TIMEOUT,success:!1})),Rg.debug("".concat(e.name," timeout")))}));const d=new p(l.UNEXPECTED_ERROR,"".concat(e.name,": this api invoke is end"));return{onSuccess:t=>{const r=()=>{if(c)throw d;return c=!0,this.sendApiInvoke(Ug(Ug({},a()),{},{success:!0},e.reportResult&&{result:t})),s&&Rg.info("".concat(e.name," onSuccess")),t};return n?f(r,e.name+"Success",n,(()=>c=!0)):r()},onError:t=>{const r=()=>{if(c)throw t;c=!0,this.sendApiInvoke(Ug(Ug({},a()),{},{success:!1,error:t})),s&&Rg.info("".concat(e.name," onFailure"),t.toString())};return n?f(r,e.name+"Error",n,(()=>c=!0)):r()}}}sessionInit(t,e){if(this.baseInfoMap.has(t))return;const o=Date.now(),i=this.createBaseInfo(t,o);i.cname=e.cname;const a=Object.assign({},{willUploadConsoleLog:r("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:d?"global":"oversea",areas:r("AREAS")&&r("AREAS").join(",")},e.extend),{stringUid:s,channelProfile:c,channelMode:u,isABTestSuccess:l,lsid:p,clientRole:f}=e,E=Date.now(),v=Ug(Ug({},i),{},{eventType:wg.SESSION_INIT,appid:e.appid,browser:navigator.userAgent,build:h,lts:E,elapse:E-o,extend:JSON.stringify(a),mode:e.mode,process:r("PROCESS_ID"),appType:r("APP_TYPE"),success:!0,version:n,stringUid:s,channelProfile:c,channelMode:u,isABTestSuccess:l,lsid:p,clientType:20,clientRole:f,serviceId:r("PROCESS_ID"),extensionID:r("PLUGIN_INFO").join(",")||""});this.send({type:Ng.SESSION,data:v},!0)}joinChooseServer(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.JOIN_CHOOSE_SERVER,lts:o,eventElapse:o-e.lts,chooseServerAddr:e.csAddr,errorCode:e.ec,elapse:o-r.startTime,success:e.succ,chooseServerAddrList:JSON.stringify(e.serverList),uid:e.uid?parseInt(e.uid):null,cid:e.cid?parseInt(e.cid):null,chooseServerIp:e.csIp||"",opid:e.opid,unilbsServerIds:e.unilbsServerIds,extend:e.extend||void 0,isHttp3:e.isHttp3});this.send({type:Ng.JOIN_CHOOSE_SERVER,data:i},!0)}reqUserAccount(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.REQ_USER_ACCOUNT,lts:o,success:e.success,serverAddress:e.serverAddr,stringUid:e.stringUid,uid:e.uid,errorCode:e.errorCode,elapse:o-r.startTime,eventElapse:o-e.lts,extend:JSON.stringify(e.extend)});this.send({type:Ng.REQ_USER_ACCOUNT,data:i},!0)}joinGateway(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info;e.vid&&(n.vid=e.vid),n.uid=e.uid,n.cid=e.cid;const o=Date.now(),{firstSuccess:i,avoidJoinStartTime:a,isProxy:s,addr:c}=e,u=o-(i&&a?a:r.startTime),l=Ug(Ug({},n),{},{eventType:wg.JOIN_GATEWAY,lts:o,gatewayAddr:e.addr,success:e.succ,errorCode:e.ec,elapse:u,eventElapse:o-e.lts,firstSuccess:i,signalChannel:e.signalChannel}),p=l.success?1:0;if(e.succ&&(r.lastJoinSuccessTime=o),i)this.send({type:Ng.JOIN_GATEWAY,data:l},!0);else{let t;if(c)if(s){const e=c.match(/h=(\d{1,3}-){3}\d{1,3}/g),r=c.match(/p=[0-9]{1,6}/g);t={isSuccess:p,gatewayIp:e&&e.length?e[0].split("=")[1].replace(/-/g,"."):"",port:r&&r.length?r[0].split("=")[1]:"",isProxy:s?1:0}}else{const e=c.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),r=c.match(/(:|p=)[0-9]{1,6}/g);t={isSuccess:p,gatewayIp:e&&e.length?e[0].split("//")[1].replace(/-/g,"."):"",port:r&&r.length?r[0].split(/:|p=/g)[1]:"",isProxy:s?1:0}}else t={isSuccess:p,gatewayIp:"",port:"",isProxy:s?1:0};delete l.success,delete l.eventType,delete l.firstSuccess,l.vid=Number(l.vid);const e=Object.assign({},l,t,{eventType:wg.REJOIN_GATEWAY});this.send({type:Ng.RE_JOIN_GATEWAY,data:e},!0)}}joinChannelTimeout(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=Date.now(),o=Ug(Ug({},r.info),{},{lts:n,timeout:e,elapse:n-r.startTime});this.send({type:Ng.JOIN_CHANNEL_TIMEOUT,data:o},!0)}publish(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.PUBLISH,lts:o,eventElapse:e.eventElapse,elapse:o-r.startTime,success:e.succ,errorCode:e.ec,videoName:e.videoName,audioName:e.audioName,screenName:e.screenName,screenshare:e.screenshare,audio:e.audio,video:e.video,p2pid:e.p2pid,publishRequestid:e.publishRequestid});this.send({type:Ng.PUBLISH,data:i},!0)}subscribe(t,e,r){const n=this.baseInfoMap.get(t);if(!n)return;const o=n.info,i=Date.now(),a=Ug(Ug({},o),{},{eventType:wg.SUBSCRIBE,lts:i,eventElapse:e.eventElapse,elapse:i-n.startTime,success:e.succ,errorCode:e.ec,video:e.video,audio:e.audio,subscribeRequestid:e.subscribeRequestid,p2pid:e.p2pid},r&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof e.peerid?a.peerSuid=e.peerid:a.peer=e.peerid,this.send({type:Ng.SUBSCRIBE,data:a},!0)}wsCompressorInit(t){var e;const r=[...ap(e=this.baseInfoMap).call(e)],n=r.length?r[0]:"UnableToGetSid",o=this.baseInfoMap.get(n);if(!o)return;const i=o.info,a=Date.now(),s=Ug(Ug({},i),{},{eventType:wg.WS_COMPRESSOR_INIT,lts:a,eventElapse:t.eventElapse,elapse:a-o.startTime,status:t.status?1:2});this.send({type:Ng.WS_COMPRESSOR_INIT,data:s},!0)}firstRemoteVideoDecode(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=Ug(Ug(Ug({},i),n),{},{elapse:a-o.startTime,eventType:e,lts:a,firstDecodeFrame:Math.max(a-o.startTime,0),apEnd:Math.max(n.apEnd-o.startTime,0),apStart:Math.max(n.apStart-o.startTime,0),joinGwEnd:Math.max(n.joinGwEnd-o.startTime,0),joinGwStart:Math.max(n.joinGwStart-o.startTime,0),pcEnd:Math.max(n.pcEnd-o.startTime,0),pcStart:Math.max(n.pcStart-o.startTime,0),subscriberEnd:Math.max(n.subscriberEnd-o.startTime,0),subscriberStart:Math.max(n.subscriberStart-o.startTime,0),videoAddNotify:Math.max(n.videoAddNotify-o.startTime,0)});this.send({type:r,data:s},!0)}firstRemoteFrame(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=Ug(Ug(Ug({},i),n),{},{elapse:a-o.startTime,eventType:e,lts:a});this.send({type:r,data:s},!0)}pcStats(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{vid:void 0===n.vid?0:Number(n.vid),elapse:o-r.startTime,eventType:wg.PC_STATS,lts:o});this.send({type:Ng.PC_STATS,data:i},!0)}updateRemoteRTPCapabilities(t,e){if(t){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{vid:void 0===n.vid?0:Number(n.vid),eventType:wg.UPDATE_REMOTE_RTPCAPABILITIES,lts:o});this.send({type:Ng.UPDATE_REMOTE_RTPCAPABILITIES,data:i},!0)}}onGatewayStream(t,e,r,n){const o=this.baseInfoMap.get(t);if(!o)return;const i=o.info,a=Date.now(),s=Ug(Ug(Ug({},i),n),{},{eventType:e,lts:a});this.send({type:r,data:s},!0)}streamSwitch(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.STREAM_SWITCH,lts:o,isDual:e.isdual,elapse:o-r.startTime,success:e.succ});this.send({type:Ng.STREAM_SWITCH,data:i},!0)}requestProxyAppCenter(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.REQUEST_PROXY_APPCENTER,lts:o,eventElapse:o-e.lts,elapse:o-r.startTime,APAddr:e.APAddr,workerManagerList:e.workerManagerList,response:e.response,errorCode:e.ec,success:e.succ});this.send({type:Ng.REQUEST_PROXY_APPCENTER,data:i},!0)}requestProxyWorkerManager(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{eventType:wg.REQUEST_PROXY_WORKER_MANAGER,lts:o,eventElapse:o-e.lts,elapse:o-r.startTime,workerManagerAddr:e.workerManagerAddr,response:e.response,errorCode:e.ec,success:e.succ});this.send({type:Ng.REQUEST_PROXY_WORKER_MANAGER,data:i},!0)}setProxyServer(t){this.proxyServer=t,t?Rg.debug("reportProxyServerurl: ".concat(t)):Rg.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug({},n),{},{subscribeElapse:e.subscribeElapse,peer:e.peer,peerPublishDuration:Math.max(e.audioPublishDuration,e.videoPublishDuration),audiotag:e.audioPublishDuration>0?1:-1,videotag:e.videoPublishDuration>0?1:-1,lts:o,elapse:o-r.startTime,joinChannelSuccessElapse:o-(r.lastJoinSuccessTime||o),peerPublishDurationVideo:e.videoPublishDuration,peerPublishDurationAudio:e.audioPublishDuration});this.send({type:Ng.PEER_PUBLISH_STATUS,data:i},!0)}workerEvent(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{elapse:o-r.startTime,lts:o,productType:"WebRTC"});E(i,"payload",1300).forEach((t=>this.send({type:Ng.WORKER_EVENT,data:t},!0)))}apworkerEvent(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{elapse:o-r.startTime,lts:o});this.send({type:Ng.AP_WORKER_EVENT,data:i},!0)}joinWebProxyAP(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{elapse:o-r.startTime,lts:o,extend:e.extend||void 0});this.send({type:Ng.JOIN_WEB_PROXY_AP,data:i},!0)}WebSocketQuit(t,e){const r=this.baseInfoMap.get(t);if(!r)return;const n=r.info,o=Date.now(),i=Ug(Ug(Ug({},n),e),{},{elapse:o-r.startTime,lts:o});this.send({type:Ng.WEBSOCKET_QUIT,data:i},!0)}async sendCustomReportMessage(t,e){if(this.customReportCount+=e.length,this.customReportCount>r("CUSTOM_REPORT_LIMIT"))throw new p(l.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const n=Date.now(),o=e.map((e=>({type:Ng.USER_ANALYTICS,data:Ug(Ug({sid:t},e),{},{lts:n})})));try{r("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(o):await this.postDataToStatsCollector(o)}catch(t){throw Rg.error("send custom report message failed",t.toString()),new p(l.CUSTOM_REPORT_SEND_FAILED,t.message)}}sendApiInvoke(t){const e=r("NOT_REPORT_EVENT");if(t.tag&&Ap(e)&&Ap(e).call(e,t.tag))return!1;if(null===t.sid)return this.apiInvokeUploadPendingItems.push(t),!1;const n=this.baseInfoMap.get(t.sid);if(!n)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:o,uid:i,cid:a}=n.info;let s;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof p){const{code:e,message:r}=t.error;s=e||(r||t.error.toString())}else s=t.error.toString();const c={invokeId:t.invokeId,sid:t.sid,cname:o,cid:a,uid:i,lts:t.lts,success:t.success,elapse:t.lts-n.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?s:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:Ng.API_INVOKE,data:c},!1),!0}appendSessionId(){Mg.__CLIENT_LIST__.forEach((t=>{if(t._sessionId){const e=this.apiInvokeUploadPendingItems.length;for(let r=0;r<e;r++){const e=this.apiInvokeUploadPendingItems.shift();e&&(e.sid=t._sessionId,this.sendApiInvoke(Object.assign({},e)))}}}))}send(t,e){if(e)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>r("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,e){const n=[],o=[];for(;t.length;){const e=t.shift();n.length<20?n.push(e):o.push(e)}t.push(...o);for(const t of[...n]){var i;if(-1!==this.ltsList.indexOf(t.data.lts))t.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(t.data.lts);else this.ltsList.push(t.data.lts),hf(i=this.ltsList).call(i,((t,e)=>t-e))}e||(this.lastSendNormalEventTime=Date.now());return r("ENABLE_EVENT_REPORT")?(n.length&&(r("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((t=>n=>{r("EVENT_REPORT_RETRY")&&(e?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(t):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(t),this.normalEventUploadPendingItems.length>r("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-r("NORMAL_EVENT_QUEUE_CAPACITY")),Rg.warning("report: drop normal events"))))})(n)),t):t}async postDataToStatsCollector2(t){s.networkState===v.OFFLINE&&await Eg.race([s.onlineWaiter,u(2*g.maxRetryTimeout)]);const e=t=>{let e=new Uint8Array;return t.forEach((t=>{const r=m(JSON.stringify(t.data)),n=new ArrayBuffer(5),o=(t=>{let e=0;return Object.entries(Ng).forEach((r=>{let[n,o]=r;o===t.type&&(e=EventNameToID[n])})),e})(t),i=new DataView(n);i.setUint16(0,r.byteLength,!0),i.setUint8(2,255&o),i.setUint8(3,o>>>8&255),i.setUint8(4,o>>>16&255),e=_(e,new Uint8Array(n)),e=_(e,r)})),e},n="event";let o=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(r("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat(r("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let i=0;i<2;i+=1){1===i&&(o=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(r("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat(r("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await y(o,{timeout:1e4,data:e(t),headers:Ug(Ug({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(t){if(1===i)throw t;continue}return}}async postDataToStatsCollector(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map((t=>JSON.stringify(t))),vid:(t=>{const e=t&&t.data.sid&&this.baseInfoMap.get(t.data.sid);return e&&e.info.vid&&+e.info.vid||0})(t[0])};s.networkState===v.OFFLINE&&await Eg.race([s.onlineWaiter,u(2*g.maxRetryTimeout)]);const o=e?"/events/proto-raws":"/events/messages";let i=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(r("EVENT_REPORT_DOMAIN"),"&p=").concat(r("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(r("EVENT_REPORT_DOMAIN"),":").concat(r("STATS_COLLECTOR_PORT")).concat(o));for(let t=0;t<2;t+=1){1===t&&(i=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(r("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(r("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(r("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(r("STATS_COLLECTOR_PORT")).concat(o)));try{e?await S(i,{timeout:1e4,data:n}):await y(i,{timeout:1e4,data:n})}catch(e){if(1===t)throw e;continue}return}}createBaseInfo(t,e){const r=Object.assign({},Pg);return r.sid=t,this.baseInfoMap.set(t,{info:r,startTime:e}),r}reportResourceTiming(t,e){const r=performance.getEntriesByName(t),n=r[r.length-1];n&&this.reportApiInvoke(e,{name:"Client.resourceTiming",options:n,tag:c.TRACER}).onSuccess()}}function jg(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,r,n){const o=n.value;if("function"==typeof o){const i=t.className||e.__className__||("AgoraRTCClient"===e.constructor.name?"Client":e.constructor.name);n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];let s=n;if(t.argsMap)try{s=t.argsMap(this,...n)}catch(t){Rg.warning(t),s=[]}try{JSON.stringify(s)}catch(t){Rg.warning("arguments for method ".concat(i,".").concat(String(r)," not serializable for apiInvoke.")),s=[]}const u=(t.report||xg).reportApiInvoke(this._sessionId||null,{name:"".concat(i,".").concat(String(r)),options:s,tag:c.TRACER,reportResult:t.reportResult},t.throttleTime);try{const e=o.apply(this,n);return e instanceof Eg?e.then((e=>(u.onSuccess(t.reportResult&&e),e))).catch((t=>{throw u.onError(t),t})):(u.onSuccess(t.reportResult&&e),e)}catch(t){throw u.onError(t),t}}}return n}}Mg.__CLIENT_LIST__=[];const xg=new Mg;vg.on("REPORT_LOG_UPLOAD",(t=>{t.networkState=s.networkState,xg.reportApiInvoke(null,{name:"logUploadError",options:t,tag:c.TRACER})}));export{Dg as AgoraEventUploadId,Og as AgoraLogger,wg as AgoraRTCEvent,Mg as AgoraRTCEventReport,Ng as AgoraRTCEventUploadType,Pg as EVENT_BASE_TEMPLATE,Lg as EventNameToID,bg as LOG_TYPE,Ig as LOG_UPLOAD_STATE,jg as apiInvoke,Ag as isEventCustomReportParams,vg as logReportBus,Rg as logger,xg as report};
