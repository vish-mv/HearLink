<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>lobby</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
</head>
<body>
    
    <main>

        <section id = "form-container">
            <div id="welcome-message">
                <h1>Welcome to MyChat</h1>
                <p>HearLink video chat platform!</p>
            </div>
            <form id="form">
                <div class="field-wrapper">
                    <div class="form-field">
                        <label for="room">Room:</label>
                        <input id="room" name="room" type="text" placeholder="Enter a room name..." style="text-transform:uppercase">
                    </div>
                    <div class="form-field">
                        <label for="name">Name:</label>
                        <input id="name" name="name" type="text" placeholder="Enter your name..." style="text-transform:uppercase">
                    </div>
                    <div class="form-field">
                        <input type="submit" value="Join Stream">
                    </div>
                </div>
            </form>
        </section>

    </main>
    



</body>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        let form = document.getElementById('form');

        let handleSubmit = async function(e) {
            e.preventDefault();
            let room = document.getElementById('room').value.toUpperCase();
            let name = document.getElementById('name').value;

            
            let data = await fetchToken(room);

            let UID = data.uid;
            let token = data.token;

            sessionStorage.setItem('UID', UID);
            sessionStorage.setItem('token', token);
            sessionStorage.setItem('room', room);
            sessionStorage.setItem('name', name);

            window.open('/room/', '_self');
        };

        form.addEventListener('submit', handleSubmit);
    });
</script>

</html>